(function(scope,$){window.GameAPI={};var api=function(){};var tempDataBigWin;var tempDataJackpot;function GET(url,done){$.ajax({type:"GET",url:url,contentType:"application/json; charset=utf-8",crossDomain:true,xhrFields:{withCredentials:true},success:function(data){if(done){done(data);}},fail:function(err){console.error('Fail API Url:',url,'\nError:',err);}});}
api.prototype.GetBigWin=function(type,callback){var url=Config.Url.Game_API+'chuadao/';switch(type){case 0:url+='bigwin';break;case 1:url+='jackpot';break;case 2:url+='GetMissBonus';break;}
GET(url,callback);}
api.prototype.GetHistory=function(callback){var url=Config.Url.Game_API+"chuadao/History?accountid="+App.CD2AccInfo.Account.AccountID
+"&username="+App.CD2AccInfo.Account.UserName;GET(url,callback);}
api.prototype.ShowVinhDanh=function(){var that=this;var html='';var html1='';var html2='';that.GetBigWin(0,function(data){console.log(data);if(data){$.each(data,function(key,val){html+='<p>Chúc mừng <b>'+val.Username+'</b> đã thắng lớn: <span>'+Utils.formatMoney(val.TotalPrize)+' Gold</span> lúc '+new Date(val.CreatedTime).yyyymmddHHmmss()+' </p>';});}});that.GetBigWin(1,function(data){if(data){$.each(data,function(key,val){html+='<p>Chúc mừng <b>'+val.Username+'</b> đã thắng hũ: <span>'+Utils.formatMoney(val.TotalPrize)+' Gold</span>lúc '+new Date(val.CreatedTime).yyyymmddHHmmss()+'</p>';});}});setTimeout(function(){if($("#vinhdanh_detail_content").attr("class").indexOf("mCustomScrollbar")>=0){$("#vinhdanh_detail_content").find(".mCSB_container").html(html);}
else{$("#vinhdanh_detail_content").html(html);$("#vinhdanh_detail_content").mCustomScrollbar();}},1000);};api.prototype.ShowHistory=function(){var that=this;showPopupData("Home/ExchangeHistory",function(){$('.avg_popup_LSGD').fadeIn(200);that.BindHistoryList(1,10);});}
api.prototype.BindHistoryList=function(currPage,recordPerPage){this.GetHistory(function(data){if(data!=undefined){var html='';var tbody='';var html_page='';var page_pre=1;if(currPage>1){page_pre=currPage-1;}
var next_page=currPage+1;html+='<thead>';html+='<tr>';html+='<td>Phiên</td>';html+='<td>Thời Gian</td>';html+='<td>Tài Khoản</td>';html+='<td>Mức Đặt</td>';html+='<td>Thắng</td>';html+='<td>Mô Tả</td>';html+='</tr>';html+='</thead>';html+='<tbody id="tbodyHistory">';var totalRow=0;totalRow=data.length;var totalPage=Math.floor(totalRow/recordPerPage)+1;$('#headerHistoryPaging').pager({pagenumber:currPage,pagecount:totalPage,buttonClickCallback:function(page){}});for(var i=(currPage-1)*recordPerPage;i<(currPage)*recordPerPage;i++){var val=data[i];if(val!=undefined){tbody+='<tr>';tbody+='<td>#'+val.SpinID+'</td>';tbody+='<td>'+new Date(val.CreatedTime).yyyymmddHHmmss()+'</td>';tbody+='<td>'+val.Username+'</td>';tbody+='<td>'+Utils.formatMoney(val.BetValue)+'</td>';tbody+='<td>'+Utils.formatMoney(val.TotalPrize)+'</td>';tbody+='<td>'+val.Description+'</td>';tbody+='</tr>';}}
html+=tbody;html+='</tbody>';html+=html_page;$("#table_cont_LSGD").html(html);$('#headerHistoryPaging').pager({pagenumber:currPage,pagecount:totalPage,buttonClickCallback:function(page){Api.BindHistoryList(page,10);}});}});}
api.prototype.ShowTableStatistic=function(type){var that=this;if(type==undefined)type=0;showPopupData("Home/TableStatistic?Type="+type,function(){$('.avg_popup_thongke').fadeIn(200);if(type==0)
{$("a[name =cont_thongke01]").trigger("click");}
if(type==1)
{$("a[name =cont_thongke02]").trigger("click");}
if(type==2)
{$("a[name =cont_thongke03]").trigger("click");}});}
api.prototype.BindTableStatisticList=function(type,currPage,recordPerPage){var that=this;this.GetBigWin(type,function(data){if(data!=undefined){var html='';var tbody='';var html_page='';var page_pre=1;if(currPage>1){page_pre=currPage-1;}
var next_page=currPage+1;html+='<table>';html+='<thead>';html+='<tr>';html+='<td>Phiên</td>';html+='<td>Thời Gian</td>';html+='<td>Tài Khoản</td>';html+='<td>Mức Đặt</td>';html+='<td>Thắng</td>';html+='<td>Mô Tả</td>';html+='</tr>';html+='</thead>';html+='<tbody id="tbodyHistory">';var totalRow=0;totalRow=data.length;var totalPage=Math.floor(totalRow/recordPerPage)+1;for(var i=(currPage-1)*recordPerPage;i<(currPage)*recordPerPage;i++){var val=data[i];var spinID=0;if(val!=undefined)
{if(type==1){spinID=val.SpinId;}else{spinID=val.SpinID}
if(val!=undefined){tbody+='<tr>';tbody+='<td>#'+spinID+'</td>';tbody+='<td>'+new Date(val.CreatedTime).yyyymmddHHmmss()+'</td>';tbody+='<td>'+val.Username+'</td>';tbody+='<td>'+Utils.formatMoney(val.BetValue)+'</td>';tbody+='<td>'+Utils.formatMoney(val.TotalPrize)+'</td>';tbody+='<td>'+val.Description+'</td>';tbody+='</tr>';}}}
html+=tbody;html+='</tbody>';html+='</table>';if(type==0)
{html_page+='<div class="paging_thongke" id="headerHistoryPaging0"> ';html_page+='<a class="prev_thongke"><img src="images/Popup/bt_Pre.png" alt=""/></a>';html_page+='<a class="active">1</a> ';html_page+='<a class="next_thongke"><img src="images/Popup/bt_Next.png" alt=""/></a>';html_page+='</div>';html+=html_page;$(".cont_thongke01 table").html(html);$('#headerHistoryPaging0').pager({pagenumber:currPage,pagecount:totalPage,buttonClickCallback:function(page){Api.BindTableStatisticList(0,page,10);}});}
if(type==1)
{html_page+='<div class="paging_thongke" id="headerHistoryPaging1"> ';html_page+='<a class="prev_thongke"><img src="images/Popup/bt_Pre.png" alt=""/></a>';html_page+='<a class="active">1</a> ';html_page+='<a class="next_thongke"><img src="images/Popup/bt_Next.png" alt=""/></a>';html_page+='</div>';html+=html_page;$(".cont_thongke02 table").html(html);$('#headerHistoryPaging1').pager({pagenumber:currPage,pagecount:totalPage,buttonClickCallback:function(page){Api.BindTableStatisticList(1,page,10);}});}
if(type==2)
{html_page+='<div class="paging_thongke" id="headerHistoryPaging2"> ';html_page+='<a class="prev_thongke"><img src="images/Popup/bt_Pre.png" alt=""/></a>';html_page+='<a class="active">1</a> ';html_page+='<a class="next_thongke"><img src="images/Popup/bt_Next.png" alt=""/></a>';html_page+='</div>';html+=html_page;$(".cont_thongke03 table").html(html);$('#headerHistoryPaging2').pager({pagenumber:currPage,pagecount:totalPage,buttonClickCallback:function(page){Api.BindTableStatisticList(2,page,10);}});}}});}
api.prototype.ShowHuongDan=function(){showPopupData("Home/ShowHuongDan",function(){$('.avg_popup_docs').fadeIn(200);});}
api.prototype.closePoup=function(){$("#poupHistory").html("");$('.avg_popup').fadeOut(200);};api.prototype.bangThuong=function(){var html='';html+='<div class="avg_popup avg_popup_large avg_popup_LSGD" style="display:block;">';html+='<span class="shadow"></span>';html+='<div class="inner">';html+='<span class="close_pop" onclick="Api.closePoup()"><img src="images/button/bt_CloseChat.png" alt="" /></span>';html+='<div class="content_pop" style="background: url(images/Popup/Pop_Bang_Thuong.png) no-repeat">';html+='<div class="cont_LSGD" id="cont_LSGD">';html+='</div>';html+='</div>';html+='</div>';html+='</div>';$("#poupHistory").html(html);}
api.prototype.huongDan=function(){api.prototype.bangThuong=function(){var html='';html+='<div class="avg_popup avg_popup_large avg_popup_LSGD" style="display:block;">';html+='<span class="shadow"></span>';html+='<div class="inner">';html+='<span class="close_pop" onclick="Api.closePoup()"><img src="images/button/bt_CloseChat.png" alt="" /></span>';html+='<div class="content_pop" style="background: url(../images/Popup/Pop_Bang_Thuong.png) no-repeat">';html+='<div class="cont_LSGD" id="cont_LSGD">';html+='</div>';html+='</div>';html+='</div>';html+='</div>';$("#poupHistory").html(html);}}
function showPopupData(dataView,callback){$.ajax({type:"GET",url:Config.Url.ROOT+dataView,crossDomain:true,xhrFields:{withCredentials:true},success:function(html){$("#poupHistory").html(html);if(callback!=undefined&&typeof callback==="function")
callback();}}).always(function(){});}
function getAjaxInfo(url,callback){$.ajax({type:"GET",url:url,cache:false,crossDomain:true,xhrFields:{withCredentials:true},success:function(response){if(callback!=undefined&&typeof callback==="function")
callback(response);}});}
window.GameAPI=api;})(window,jQuery);