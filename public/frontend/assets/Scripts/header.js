var configHeader={urlConfig:{headerUrl:'http://vzon.club/',authenUrl:'http://authen.vzon.club/',loyaltyUrl:'',eventUrl:'http://event.vzon.club/',commonUrl:''}}
if(location.href.indexOf("alpha")>-1){configHeader.urlConfig.headerUrl='http://alpha.vzon.club/portal/';configHeader.urlConfig.authenUrl='http://alpha.vzon.club/authen/';configHeader.urlConfig.eventUrl='http://alpha.vzon.club/event/';}
if(location.href.indexOf("localhost")>-1){configHeader.urlConfig.headerUrl='http://localhost:3575/';configHeader.urlConfig.authenUrl='http://45.77.33.149/PortalApi/';configHeader.urlConfig.eventUrl='http://alpha.vzon.club/event/';}
var commonLoadMinigameUrls={MiniPoker:["http://vzon.club/minipoker/scripts/Minipoker.js"],MiniLongPhung:["http://vzon.club/longphung/scripts/MiniLongPhung.js"],MiniLuckyDice:["http://vzon.club/luckydice/scripts/LuckyDice.js"],MiniThienHa:["http://vzon.club/thienha/scripts/thienha.js"]}
if(window.location.href.indexOf('http://alpha.')>-1){commonLoadMinigameUrls={MiniPoker:["http://alpha.vzon.club/minipoker/scripts/Minipoker.js"],MiniLongPhung:["http://alpha.vzon.club/longphung/scripts/MiniLongPhung.js"],MiniLuckyDice:["http://alpha.vzon.club/luckydice/scripts/LuckyDice.js"],MiniThienHa:["http://alpha.vzon.club/thienha/scripts/thienha.js"]}}
if(window.location.href.indexOf('http://localhost')>-1){commonLoadMinigameUrls={MiniPoker:["http://localhost:10413/scripts/Minipoker.js"],MiniLongPhung:["http://localhost:55077/scripts/MiniLongPhung.js"],MiniLuckyDice:["http://localhost:10454/scripts/LuckyDice.js"],MiniThienHa:["http://localhost:1033/scripts/thienha.js"]}}
var Utils=(function($){var scaleChg=1;function showOverlayPopup(html,zIndex){if(zIndex==undefined||!(zIndex>=0)){zIndex=1000;}
closeOverlayPopup();if($("#hpopup_wrap").length<1){$("body").append("<div id='hpopup_container' style='z-index:"+zIndex+";position:absolute'><div id='hpopup_overlay'></div><div id='hpopup_wrap'></div></div>");$("#hpopup_wrap").html(html);$("#hpopup_wrap, #hpopup_overlay").css("position","fixed");var nWidth=parseFloat($("#hpopup_wrap").css("width"));var nHeight=parseFloat($("#hpopup_wrap").css("height"));var top=$(window).height()/scaleChg/2-nHeight/2;var left=$(window).width()/scaleChg/2-nWidth/2;$("#hpopup_wrap").css("top",top);$("#hpopup_wrap").css("left",left);$("#hpopup_overlay").css("width","100%");$("#hpopup_overlay").css("height",$(window).height()/scaleChg);$("#hpopup_overlay").css("background-color","black");$("#hpopup_overlay").css("opacity","0.75");$("#hpopup_overlay").css("top","0");}}
function closeOverlayPopup(){if($("#hpopup_container").length>0){$("#hpopup_container").remove();}}
function isNumeric(n){return!isNaN(parseFloat(n))&&isFinite(n);}
function showLoading(){hideLoading();if($("#ld_wrap").length<1){$("body").append("<div id='ld_container' style='z-index:50000;width: 100%;height: 100%;position: fixed;top: 0px;'><div id='ld_overlay'></div><div id='ld_wrap'></div></div>");var loadingHtml='<div id="circularG">'
+'<div id="circularG_1" class="circularG"></div>'
+'<div id="circularG_2" class="circularG"></div>'
+'<div id="circularG_3" class="circularG"></div>'
+'<div id="circularG_4" class="circularG"></div>'
+'<div id="circularG_5" class="circularG"></div>'
+'<div id="circularG_6" class="circularG"></div>'
+'<div id="circularG_7" class="circularG"></div>'
+'<div id="circularG_8" class="circularG"></div>'
+'</div>';$("#ld_wrap").html(loadingHtml);$("#ld_wrap, #ld_overlay").css("position","fixed");var nWidth=parseInt($("#ld_wrap").css("width"));var nHeight=parseInt($("#ld_wrap").css("height"));var top=$(window).height()/scaleChg/2-nHeight/2;var left=$(window).width()/scaleChg/2-nWidth/2;$("#ld_wrap").css("top",top);$("#ld_wrap").css("left",left);$("#ld_overlay").css("width","100%");$("#ld_overlay").css("height","100%");$("#ld_overlay").css("background-color","black");$("#ld_overlay").css("opacity","0.75");}}
function hideLoading(){$("#ld_container").remove();}
function formatMoney(money){if(money==undefined)return '';var strMoney=money.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".");return strMoney;}
function replaceAll(str,replace,with_this){var str_hasil="";var temp;for(var i=0;i<str.length;i++)
{if(str[i]==replace){temp=with_this;}
else{temp=str[i];}
str_hasil+=temp;}
return str_hasil;}
function detectMobile(){if(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)){return true;}
else{return false;}}
function copyToClipboard(elem){var targetId="_hiddenCopyText_";var isInput=elem.tagName==="INPUT"||elem.tagName==="TEXTAREA";var origSelectionStart,origSelectionEnd;if(isInput){target=elem;origSelectionStart=elem.selectionStart;origSelectionEnd=elem.selectionEnd;}else{target=document.getElementById(targetId);if(!target){var target=document.createElement("textarea");target.style.position="absolute";target.style.left="-9999px";target.style.top="0";target.id=targetId;document.body.appendChild(target);}
target.textContent=elem.textContent;}
var currentFocus=document.activeElement;target.focus();target.setSelectionRange(0,target.value.length);var succeed;try{succeed=document.execCommand("copy");}catch(e){succeed=false;}
if(currentFocus&&typeof currentFocus.focus==="function"){currentFocus.focus();}
if(isInput){elem.setSelectionRange(origSelectionStart,origSelectionEnd);}else{target.textContent="";}
return succeed;}
$.loadStyleSheet=function(url,callback){if(document.createStyleSheet){try{document.createStyleSheet(url);}catch(e){}}
else{var css;css=document.createElement('link');css.rel='stylesheet';css.type='text/css';css.media="all";css.href=url;document.getElementsByTagName("head")[0].appendChild(css);}
if(callback){callback();}}
$.loadMultiStyleSheet=function(styleSheets,callback){var array=[];styleSheets.forEach(function(styleSheet){array.push($.loadStyleSheet(styleSheet));});return $.when.apply($,array).always(function(){if(callback){callback();}});}
$.loadMultiScripts=function(scripts,callback){var array=[];scripts.forEach(function(script){array.push($.getScript(script));});$.when.apply($,array).always(function(){if(callback){callback();}});}
return{showOverlayPopup:function(html,zIndex){showOverlayPopup(html,zIndex);},closeOverlayPopup:function(){closeOverlayPopup();},showLoading:function(){showLoading();},hideLoading:function(){hideLoading();},formatMoney:function(money){return formatMoney(money)},mobileCheck:function(){return detectMobile();},replaceAll:function(str,replace,with_this){return replaceAll(str,replace,with_this);},isNumeric:function(n){return isNumeric(n)},copyToClipboard:function(n){return copyToClipboard(n)}}})($);var GlobalHeader=(function($){var globalHeader={};var logoutUrl="";var isLogin=0;var smsPlusMobile="";globalHeader.InitMinigame=null;globalHeader.AccountId='';globalHeader.AccountName='';globalHeader.NickName='';globalHeader.TotalUpdateNick=1;var loginInfo={Username:'',PasswordMd5:'',Captcha:'',Verify:'',ServiceId:'',UrlRoot:'',ContinueUrl:''};var loginOutput={AccountId:'',UserName:'',TotalStar:'',IsOtp:'',OtpToken:'',IsCaptcha:'',ResponseCode:'',Description:''};var itemsId={HeaderInfoDiv:'divHeaderInfo',HeaderOptionsDiv:'headerOptions',HeaderChooseOptions:'headerChooseOptions',NickName:'headerNickName',Avatar:'headerAvatar',LoyaltyPoint:'headerLoyalty',MailTotal:'headerMailTotal',RealCoinValue:'headerRealCoinValue',PlayCoinValue:'headerPlayCoinValue',DivCaptcha:'headerDivCaptcha',CaptchaImg:'headerCaptchaImg',CaptchaVerify:'headerCaptchaVerify',ContentPopup:'headerContentPopup',OverlayPopupLevel2:'headerOverlayPopupLevel2',ContentPopupLevel2:'headerContentPopupLevel2',InputUserName:'headerInputUser',InputOldPassword:'headerInputOldPass',InputPassword:'headerInputPass',InputRePassword:'headerInputRePass',InputCaptchaUser:'headerCaptchaInput',InputSecureType:'headerInputSecureType',InputSecureCode:'headerInputSecureCode',InputPolicy:'headerInputPolicy',InputPhoneNumber:'headerInputPhoneNumber',InputNickName:'headerInputNickName',InputGiftcode:'headerInputGiftcode',InputCardType:'headerInputCardType',InputCardSerial:'headerInputCardSerial',InputCardCode:'headerInputCardCode',InputFreezeValue:'headerInputFreezeValue',InputFreezeType:'headerInputFreezeType',InputExchangeCoin:'headerInputExchangeCoin',InputLoginToken:'headerInputLoginToken',InputTransferNickName:'headerInputTransferNickName',InputTransferReNickName:'headerInputTransferReNickName',InputTransferValue:'headerInputTransferValue',InputTransferDescription:'headerInputTransferDescription',DivBlockGameInfo:'headerDivBlockGameInfo',DivSecureCode:'headerDivSecureCode',FreezeRealCoinValue:'headerRealCoinBalance',FreezeFreezeValue:'headerFreezeBalance',ErrorDivMessage:'headerDivErrorMessage',ErrorMessage:'headerErrorMessage',ErrorDivMessageLevel2:'headerDivErrorMessageLevel2',ErrorMessageLevel2:'headerErrorMessageLevel2'}
globalHeader.InitHeader=function(data){addGaInfo();if(data==undefined||data.ServiceId<=0)return;loginInfo.ServiceId=data.ServiceId;loginInfo.UrlRoot=data.UrlRoot;loginInfo.ContinueUrl=data.LoginUrl;isLogin=0;if(data.IsLogin){isLogin=1;}
logoutUrl=data.LogoutUrl;renderHeader(data);}
function renderHeader(data){$.ajax({type:"GET",url:configHeader.urlConfig.headerUrl+"Home/Header?isLogin="+isLogin+"&accountId="+data.AccountId,crossDomain:true,xhrFields:{withCredentials:true},success:function(html){if($("#"+itemsId.HeaderInfoDiv).length>0){$("#"+itemsId.HeaderInfoDiv).html('');}
$("#"+itemsId.HeaderInfoDiv).css("position","absolute");$("#"+itemsId.HeaderInfoDiv).css("z-index","2000");$("#"+itemsId.HeaderInfoDiv).css("width","100%");$("#"+itemsId.HeaderInfoDiv).html(html);if(globalHeader.AccountId>0){updateAccountHeader();}}});}
function renderAccountInfo(data){if(data!=undefined&&data.ResponseCode>=0){if(data.Avatar.length>0){if(data.Avatar.indexOf("http://")==-1){data.Avatar=configHeader.urlConfig.headerUrl+"Contents/avatar/"+data.Avatar;}
$("#"+itemsId.Avatar).attr("src",data.Avatar);}
if(data.NickName.length>0){$("#"+itemsId.NickName).html(data.NickName);}else{$("#"+itemsId.NickName).html(data.UserName);GlobalHeader.ShowUpdateNickName(data.TotalUpdateNick);}
GlobalHeader.UpdateRealCoinBalance(data.Star);GlobalHeader.UpdatePlayCoinBalance(data.Coin);globalHeader.AccountId=data.AccountID;globalHeader.AccountName=data.UserName;globalHeader.NickName=data.NickName;globalHeader.TotalUpdateNick=data.TotalUpdateNick;if(data.NickName.length>0){if(globalHeader.InitMinigame==null){globalHeader.InitMinigame=new CommonLoadMinigame(true);}
setTimeout(function(){if(typeof(EventVqh2)==="object"){$("#miniPokerMain").append('<div id="miniPokerEvent"></div>');$("#wrapper_thienHa").append('<div id="thienHaEvent"></div>');EventVqh2.InitEvent();setTimeout(function(){EventVqh2.BinEventMiniPoker();},1000);}},6000);}}}
function updateAccountHeader(){getAjaxInfo(configHeader.urlConfig.authenUrl+"api/Account/GetAccountInfo",function(data){renderAccountInfo(data);});}
globalHeader.UpdateRealCoinBalance=function(balance){if(!isNaN(balance)){$("#"+itemsId.RealCoinValue).html(Utils.formatMoney(balance));}}
globalHeader.UpdatePlayCoinBalance=function(balance){if(!isNaN(balance)){$("#"+itemsId.PlayCoinValue).html(Utils.formatMoney(balance));}}
globalHeader.ShowLoginPopup=function(){showPopupData("Home/PopupLogin",1);}
globalHeader.ShowLuckySpin=function(){if(gtag&&gtag!==undefined){gtag('event','VongQuay',{'event_category':'VongQuay-click','event_label':'VongQuay click Campaign'});}
showPopupData("LuckySpin/Index",1);}
globalHeader.LoginUser=function(){hideMessageError();if($("#"+itemsId.DivSecureCode).is(":visible")){GlobalHeader.LoginOtp();return;}
var txtAccount=$("#"+itemsId.InputUserName).val();var txtPassword=$("#"+itemsId.InputPassword).val();if(txtAccount==undefined||txtAccount.length<4||txtAccount.length>16){showMessageError("Vui lòng nhập chính xác tên tài khoản");$("#"+itemsId.InputUserName).focus();return;}
if(txtPassword==undefined||txtPassword.length<6||txtPassword.length>18){showMessageError("Vui lòng nhập chính xác mật khẩu");$("#"+itemsId.InputPassword).focus();return;}
var loginCaptcha='';var loginVerify='';if($("#"+itemsId.DivCaptcha).is(":visible")){loginCaptcha=$("#"+itemsId.InputCaptchaUser).val();loginVerify=$("#"+itemsId.CaptchaVerify).val();if(loginCaptcha==undefined||loginCaptcha.length==0){showMessageError("Vui lòng nhập mã bảo vệ");$("#"+itemsId.InputCaptchaUser).focus();return;}}
txtAccount=txtAccount.trim();txtPassword=txtPassword.trim();loginCaptcha=loginCaptcha.trim();var hash=md5(txtPassword);loginInfo.Username=txtAccount;loginInfo.PasswordMd5=hash;loginInfo.Captcha=loginCaptcha;loginInfo.Verify=loginVerify;Utils.showLoading();jQuery.ajax({type:"POST",url:configHeader.urlConfig.authenUrl+"api/Account/LoginUser",data:JSON.stringify(loginInfo),contentType:"application/json; charset=utf-8",dataType:"json",crossDomain:true,xhrFields:{withCredentials:true},success:function(data){if(data.IsCaptcha>0){GlobalHeader.RefreshCaptcha();showMessageError(data.Description);var utm_campaign=getParameterByName('utm_campaign',window.location.href);if(utm_campaign==undefined||utm_campaign===''){utm_campaign="Tracking";}
if(gtag&&gtag!==undefined){gtag('event','LoginUser',{'event_category':'LoginUser-Captcha','event_label':utm_campaign});}
return;}else{if(data.IsOtp>0){GlobalHeader.ShowLoginOtp(data.OtpToken,txtAccount,hash);showMessageError(data.Description);var utm_campaign=getParameterByName('utm_campaign',window.location.href);if(utm_campaign==undefined||utm_campaign===''){utm_campaign="Tracking";}
if(gtag&&gtag!==undefined){gtag('event','LoginUser',{'event_category':'LoginUser-OTP','event_label':utm_campaign});}}else{if(data.ResponseCode<0){showMessageError(data.Description);var utm_campaign=getParameterByName('utm_campaign',window.location.href);if(utm_campaign==undefined||utm_campaign===''){utm_campaign="Tracking";}
if(gtag&&gtag!==undefined){gtag('event','LoginUser',{'event_category':'LoginUser-Fail','event_label':utm_campaign});}}else{var utm_campaign=getParameterByName('utm_campaign',window.location.href);if(utm_campaign==undefined||utm_campaign===''){utm_campaign="Tracking";}
if(gtag&&gtag!==undefined){gtag('event','LoginUser',{'event_category':'LoginUser-Success','event_label':utm_campaign});}
window.location=data.Description;}}}}}).always(function(){Utils.hideLoading();if($("#"+itemsId.DivCaptcha).is(":visible")){GlobalHeader.RefreshCaptcha();}});}
globalHeader.ShowLoginOtp=function(tokenValue,userName,pass){showPopupData("Home/PopupLoginSecure",1,0,function(){var i=0;var interval=setInterval(function(){if($("#"+itemsId.InputLoginToken).length>0){$("#"+itemsId.InputLoginToken).val(tokenValue);$("#headerInputLoginUser").val(userName);$("#headerInputLoginPass").val(pass);clearInterval(interval);interval=0;}
i++;if(i>200){clearInterval(interval);interval=0;}},500);});}
globalHeader.ShowLoginOtpOpenAuthen=function(tokenValue){showPopupData("Home/PopupLoginSecure",1,0,function(){var i=0;var interval=setInterval(function(){if($("#"+itemsId.InputLoginToken).length>0){$("#"+itemsId.InputLoginToken).val(tokenValue);$("#headerInputLoginUser").val('-------');$(".closein").removeAttr("onclick");$(".closein").bind("click",function(){location.href=loginInfo.UrlRoot;});clearInterval(interval);interval=0;}
i++;if(i>200){clearInterval(interval);interval=0;}},500);});}
globalHeader.GetOtpCodeLogin=function(){hideMessageError();var userName=$("#headerInputLoginUser").val();var pass=$("#headerInputLoginPass").val();var token=$("#"+itemsId.InputLoginToken).val();if(userName=='-------'){Utils.showLoading();$.ajax({type:"GET",url:configHeader.urlConfig.authenUrl+"api/ProcessSecurity/ProcessOtpOpenAuthen?otpToken="+encodeURIComponent(token),data:JSON.stringify(),contentType:"application/json; charset=utf-8",dataType:"json",crossDomain:true,xhrFields:{withCredentials:true},success:function(data){if(data.ResponseCode<0){showMessageError(data.Description);}else{showMessageError("Gửi tin nhắn thành công");}}}).always(function(){Utils.hideLoading();});}else{Utils.showLoading();$.ajax({type:"GET",url:configHeader.urlConfig.authenUrl+"api/ProcessSecurity/ProcessOtp?accountName="+userName+"&passMd5="+pass,data:JSON.stringify(),contentType:"application/json; charset=utf-8",dataType:"json",crossDomain:true,xhrFields:{withCredentials:true},success:function(data){if(data.ResponseCode<0){showMessageError(data.Description);}else{showMessageError("Gửi tin nhắn thành công");}}}).always(function(){Utils.hideLoading();});}}
globalHeader.GetOtpCodeFogetPass=function(){hideMessageError();var userName=$("#headerInputUser").val();var mobile=$("#headerInputPhoneNumber").val();if(userName==undefined||userName.length<4){showMessageError("Vui lòng nhập tên tài khoản");$("#headerInputUser").focus();return;}
if(mobile==undefined||mobile.length<9){showMessageError("Vui lòng nhập số điện thoại");$("#headerInputPhoneNumber").focus();return;}
mobile="84"+mobile.substring(1,mobile.length);Utils.showLoading();$.ajax({type:"GET",url:configHeader.urlConfig.authenUrl+"api/ProcessSecurity/ProcessGetOtpOdpGetPass?accountName="+userName+"&mobile="+mobile,data:JSON.stringify(),contentType:"application/json; charset=utf-8",dataType:"json",crossDomain:true,xhrFields:{withCredentials:true},success:function(data){if(data.ResponseCode<0){showMessageError(data.Description);}else{showMessageError("Gửi tin nhắn thành công");}}}).always(function(){Utils.hideLoading();});}
globalHeader.GetOtpCodeRequest=function(){hideMessageError();hideMessageErrorLevel2();Utils.showLoading();$.ajax({type:"GET",url:configHeader.urlConfig.authenUrl+"api/ProcessSecurity/ProcessGetOtpOdp?type=1",data:JSON.stringify(),contentType:"application/json; charset=utf-8",dataType:"json",crossDomain:true,xhrFields:{withCredentials:true},success:function(data){if(data.ResponseCode<0){showMessageError(data.Description);showMessageErrorLevel2(data.Description);}else{showMessageError("Gửi tin nhắn thành công");showMessageErrorLevel2("Gửi tin nhắn thành công");}}}).always(function(){Utils.hideLoading();});}
globalHeader.GetOdpCodeRequest=function(){hideMessageError();Utils.showLoading();$.ajax({type:"GET",url:configHeader.urlConfig.authenUrl+"api/ProcessSecurity/ProcessGetOtpOdp?type=2",data:JSON.stringify(),contentType:"application/json; charset=utf-8",dataType:"json",crossDomain:true,xhrFields:{withCredentials:true},success:function(data){if(data.ResponseCode<0){showMessageError(data.Description);}else{showMessageError("Gửi tin nhắn thành công");}}}).always(function(){Utils.hideLoading();});}
globalHeader.LoginOtp=function(){hideMessageError()
var txtOtp=$("#"+itemsId.InputSecureCode).val();if(txtOtp==undefined||txtOtp.length<4){showMessageError("Vui lòng nhập mã OTP");$("#"+itemsId.InputSecureCode).focus();return;}
var loginCaptcha='';var loginVerify='';if($("#"+itemsId.DivCaptcha).is(":visible")){loginCaptcha=$("#"+itemsId.InputCaptchaUser).val();loginVerify=$("#"+itemsId.CaptchaVerify).val();if(loginCaptcha==undefined||loginCaptcha.length==0){showMessageError("Vui lòng nhập mã bảo vệ");$("#"+itemsId.InputCaptchaUser).focus();return;}}
var otpToken=$("#"+itemsId.InputLoginToken).val();var otpLogin={OtpType:1,Otp:txtOtp,OtpToken:otpToken,Captcha:loginCaptcha,Verify:loginVerify,PasswordMd5:loginInfo.PasswordMd5,ServiceId:loginInfo.ServiceId,UrlRoot:loginInfo.UrlRoot,ContinueUrl:loginInfo.ContinueUrl}
Utils.showLoading();$.ajax({type:"POST",url:configHeader.urlConfig.authenUrl+"api/Account/LoginUserUsingOtp",data:JSON.stringify(otpLogin),contentType:"application/json; charset=utf-8",dataType:"json",crossDomain:true,xhrFields:{withCredentials:true},success:function(data){Utils.hideLoading();if(data.IsCaptcha>0){GlobalHeader.RefreshCaptcha();var utm_campaign=getParameterByName('utm_campaign',window.location.href);if(utm_campaign==undefined||utm_campaign===''){utm_campaign="Tracking";}
if(gtag&&gtag!==undefined){gtag('event','LoginUser',{'event_category':'LoginUser-Captcha','event_label':utm_campaign});}
showMessageError(data.Description);return;}
else{if(data.ResponseCode<0){showMessageError(data.Description);var utm_campaign=getParameterByName('utm_campaign',window.location.href);if(utm_campaign==undefined||utm_campaign===''){utm_campaign="Tracking";}
if(gtag&&gtag!==undefined){gtag('event','LoginUser',{'event_category':'LoginUser-Fail','event_label':utm_campaign});}}
else{isLogin=true;var utm_campaign=getParameterByName('utm_campaign',window.location.href);if(utm_campaign==undefined||utm_campaign===''){utm_campaign="Tracking";}
if(gtag&&gtag!==undefined){gtag('event','LoginUser',{'event_category':'LoginUser-Success','event_label':utm_campaign});}
window.location=data.Description;}}}}).always(function(){Utils.hideLoading();if($("#"+itemsId.DivCaptcha).is(":visible")){GlobalHeader.RefreshCaptcha();}});}
globalHeader.LoginOpenId=function(type){var redirectLink='';var authentype='';if(type==1){authentype='facebook';}else if(type==2){authentype='google';}else{return;}
redirectLink=configHeader.urlConfig.authenUrl+'Api/Account/LoginOpenId?LoginType='+authentype+'&ServiceId='+loginInfo.ServiceId+
'&UrlRoot='+encodeURIComponent(loginInfo.UrlRoot)+"&ContinueUrl="+encodeURIComponent(loginInfo.ContinueUrl)+"&TrackingUri="+encodeURIComponent(location.href);if(gtag&&gtag!==undefined){var utm_campaign=getParameterByName('utm_campaign',window.location.href);if(utm_campaign==undefined||utm_campaign==''){utm_campaign="Tracking";}
gtag('event','NRU',{'event_category':'Click-Authen-OpenID','event_label':'Click-Authen-OpenID Campaign','authentype':authentype,'utm_campaign':utm_campaign});}
var utm_campaign=getParameterByName('utm_campaign',window.location.href);if(utm_campaign==undefined||utm_campaign==''){utm_campaign="Tracking";}
if(gtag&&gtag!==undefined){gtag('event','Click-Authen-OpenID',{'event_category':authentype,'event_label':utm_campaign});}
window.location=redirectLink;}
globalHeader.Logout=function(){var url=configHeader.urlConfig.authenUrl+"api/Account/Logout?continueUrl="+logoutUrl;window.location.href=url;return;}
globalHeader.ToggleHeaderOptions=function(){$("#"+itemsId.HeaderOptionsDiv).toggle();$("#"+itemsId.HeaderChooseOptions).toggle();}
globalHeader.ShowRegisterPopup=function(){showPopupData("Home/PopupRegister",1);}
globalHeader.QuickRegister=function(notRepass){hideMessageError();var txtAccount=$("#"+itemsId.InputUserName).val();var txtPassword=$("#"+itemsId.InputPassword).val();var txtRePassword=$("#"+itemsId.InputRePassword).val();var captCha=$("#"+itemsId.InputCaptchaUser).val();var verify=$("#"+itemsId.CaptchaVerify).val();if(txtAccount==''){showMessageError("Vui lòng nhập tên tài khoản");return;}
if(txtAccount.length<4||txtAccount.length>16||!txtAccount.match(/[a-z0-9]+/i)||!txtAccount.charAt(0).match(/[a-z]+/i)){$("#"+itemsId.InputUserName).focus();showMessageError("Tên tài khoản từ 4-16 ký tự và bắt đầu bằng chữ cái");return;}
if(txtPassword==''){$("#"+itemsId.InputPassword).focus();showMessageError("Vui lòng nhập mật khẩu");return;}
if(txtPassword.length<6||txtPassword.length>18){$("#"+itemsId.InputPassword).focus();showMessageError("Mật khẩu có độ dài 6-18 ký tự");return;}
if(!(notRepass>0)&&txtRePassword!=txtPassword){$("#"+itemsId.InputRePassword).focus();showMessageError("Nhập lại mật khẩu không chính xác!");return;}
if(captCha==''||captCha.length<3){$("#"+itemsId.InputCaptchaUser).focus();showMessageError("Vui lòng chính xác nhập mã kiểm tra");return;}
if(gtag&&gtag!==undefined){gtag('event','Register',{'event_category':'Register-Click','event_label':'Tracking'});}
var registerData={UserName:txtAccount,Password:txtPassword,Captcha:captCha,Verify:verify,ServiceId:loginInfo.ServiceId,UrlRoot:loginInfo.UrlRoot,ContinueUrl:loginInfo.ContinueUrl,TrackingUri:window.location.href};Utils.showLoading();$.ajax({type:"POST",url:configHeader.urlConfig.authenUrl+"api/Account/QuickRegister",data:JSON.stringify(registerData),contentType:"application/json; charset=utf-8",dataType:"json",crossDomain:true,xhrFields:{withCredentials:true},success:function(data){if(data.ResponseCode>0){if(location.href.indexOf("landing")>-1){fbq('track','CompleteRegistration');}
if(gtag&&gtag!==undefined){gtag('event','NRU',{'event_category':'Register-Success','event_label':'Tracking'});}
window.location=data.Description;return;}
if(gtag&&gtag!==undefined){gtag('event','NRU',{'event_category':'Register-Fail','event_label':'Tracking'});}
showMessageError(data.Description);Utils.hideLoading();}}).always(GlobalHeader.RefreshCaptcha);}
globalHeader.ShowChangePassword=function(){showPopupData("Home/ChangePassword",1);}
globalHeader.ChangePassword=function(){hideMessageError();var txtOtp=$("#"+itemsId.InputSecureCode).val();if(txtOtp==undefined||txtOtp.length<4){showMessageError("Vui lòng nhập mã OTP");$("#"+itemsId.InputSecureCode).focus();return;}
var oldPass=$("#"+itemsId.InputOldPassword).val();if(oldPass==undefined||oldPass.length<4||oldPass.length>18){showMessageError("Vui lòng nhập chính xác mật khẩu cũ");$("#"+itemsId.InputOldPassword).focus();return;}
var pass1=$("#"+itemsId.InputPassword).val();if(pass1==undefined||pass1.length<4||pass1.length>18){showMessageError("Mật khẩu mới có độ dài từ 4 đến 18 ký tự");$("#"+itemsId.InputPassword).focus();return;}
var pass2=$("#"+itemsId.InputRePassword).val();if(pass1!=pass2){showMessageError("Mật khẩu xác nhận không trùng khớp");$("#"+itemsId.InputRePassword).focus();return;}
var txtCaptcha=$("#"+itemsId.InputCaptchaUser).val();if(txtCaptcha==undefined||txtCaptcha.length<3){showMessageError("Vui lòng nhập mã xác nhận");$("#"+itemsId.InputCaptchaUser).focus();return;}
var data={OldPass:oldPass,NewPass:pass1,Captcha:txtCaptcha,Verify:$("#"+itemsId.CaptchaVerify).val(),OtpType:1,Otp:txtOtp}
Utils.showLoading();$.ajax({type:"POST",url:configHeader.urlConfig.authenUrl+"api/Account/ChangePass",data:data,crossDomain:true,xhrFields:{withCredentials:true},success:function(data){showMessageError(data.Message);if(data.responseStatus>0){$("#"+itemsId.InputOldPassword).val("");$("#"+itemsId.InputRePassword).val("");$("#"+itemsId.InputPassword).val("");$("#"+itemsId.InputSecureCode).val("");setTimeout(function(){GlobalHeader.Logout();},2000);}}}).always(function(){Utils.hideLoading();GlobalHeader.RefreshCaptcha();});}
globalHeader.ShowForgetPassword=function(){showPopupData("Home/ForgetPassword",1);}
globalHeader.ResetPassword=function(){var type=$("#"+itemsId.InputSecureType).val();if(type==1){resetPasswordBySms();}else if(type==2){resetPasswordByEmail();}}
function resetPasswordBySms(){hideMessageError();var txtAccount=$("#"+itemsId.InputUserName).val();if(txtAccount==undefined||txtAccount.length<4){showMessageError("Vui lòng nhập tên tài khoản");$("#"+itemsId.InputUserName).focus();return;}
var txtOtp=$("#"+itemsId.InputSecureCode).val();if(txtOtp==undefined||txtOtp.length<4){showMessageError("Vui lòng nhập mã OTP");$("#"+itemsId.InputSecureCode).focus();return;}
var pass1=$("#"+itemsId.InputPassword).val();var pass2=$("#"+itemsId.InputRePassword).val();if(pass1==undefined||pass1.length<4||pass1.length>18){showMessageError("Mật khẩu mới có độ dài từ 4 đến 18 ký tự");$("#"+itemsId.InputPassword).focus();return;}
if(pass1!=pass2){showMessageError("Mật khẩu xác nhận không trùng khớp");$("#"+itemsId.InputRePassword).focus();return;}
var txtCaptcha=$("#"+itemsId.InputCaptchaUser).val();if(txtCaptcha==undefined||txtCaptcha.length<3){showMessageError("Vui lòng nhập mã xác nhận");$("#"+itemsId.InputCaptchaUser).focus();return;}
var resetPassword={AccountName:txtAccount,Email:'',Type:1,SecureCode:txtOtp,NewPassword:pass1,Token:$("#"+itemsId.CaptchaVerify).val(),Captcha:txtCaptcha};Utils.showLoading();$.ajax({type:"POST",url:configHeader.urlConfig.authenUrl+"api/Account/ResetPassword",data:resetPassword,crossDomain:true,xhrFields:{withCredentials:true},success:function(data){Utils.hideLoading();if(data.ResponseCode<0){GlobalHeader.RefreshCaptcha();showMessageError(data.Description);}else{showMessageError("Chúc mừng bạn đã lấy lại mật khẩu thành công");}}}).always(function(){Utils.hideLoading();GlobalHeader.RefreshCaptcha();});}
globalHeader.ShowSecurityInfo=function(){Utils.showLoading();getAjaxInfo(configHeader.urlConfig.authenUrl+"api/AccountSecurity/GetSmsPlusMobileInfo",function(data){if(data!=undefined&&data.responseCode>0&&data.extend!=undefined&&data.extend.length>0){smsPlusMobile=data.extend.split("|")[1];}
showPopupData("Security/Main?type="+data.responseCode,1,1);});}
globalHeader.ShowRegisterSmsPlus=function(){showPopupData("Security/RegisterSmsPlus",1);}
globalHeader.RegisterSmsPlusStep1=function(){hideMessageError();var txtPhoneNumber=$("#"+itemsId.InputPhoneNumber).val();if(txtPhoneNumber==undefined||txtPhoneNumber.length<10||txtPhoneNumber.length>11||!txtPhoneNumber.startsWith("0")){showMessageError("Số điện thoại không hợp lệ");$("#"+itemsId.InputPhoneNumber).focus();return;}
var cbagree=$('#'+itemsId.InputPolicy).is(':checked');if(!cbagree){showMessageError('Bạn chưa đồng ý với điều khoản sử dụng dịch vụ');return;}
var registermodel={phoneNumber:txtPhoneNumber};Utils.showLoading();$.ajax({type:"POST",url:configHeader.urlConfig.authenUrl+"api/AccountSecurity/VerifyMobileNumber",data:registermodel,crossDomain:true,xhrFields:{withCredentials:true},success:function(data){if(data.responseCode<0){showMessageError(data.description);}else{showHtmlPopupLevel2();}}}).always(function(){Utils.hideLoading();});}
globalHeader.RegisterSmsPlusStep2=function(){hideMessageErrorLevel2();var txtPhoneNumber=$("#"+itemsId.InputPhoneNumber).val();if(txtPhoneNumber==undefined||txtPhoneNumber.length<10||txtPhoneNumber.length>11||!txtPhoneNumber.startsWith("0")){showMessageErrorLevel2("Số điện thoại không hợp lệ");$("#"+itemsId.InputPhoneNumber).focus();return;}
var otpValue=$("#"+itemsId.InputSecureCode).val();if(otpValue==undefined||otpValue.length!=6){showMessageErrorLevel2('Vui lòng nhập mã xác thực hợp lệ');$("#"+itemsId.InputSecureCode).focus();return;}
var cbagree=$('#'+itemsId.InputPolicy).is(':checked');if(!cbagree){showMessageErrorLevel2('Bạn chưa đồng ý với điều khoản sử dụng dịch vụ');return;}
var registermodel={phoneNumber:txtPhoneNumber,otp:otpValue};Utils.showLoading();$.ajax({type:"POST",url:configHeader.urlConfig.authenUrl+"api/AccountSecurity/VerifyMobileNumber",data:registermodel,crossDomain:true,xhrFields:{withCredentials:true},success:function(data){if(data.responseCode<0){showMessageErrorLevel2(data.description);}else{showMessageErrorLevel2(data.description);setTimeout(function(){GlobalHeader.ClosePopupLevel2();GlobalHeader.ShowSecurityInfo();},1500);}}}).always(function(){Utils.hideLoading();$("#"+itemsId.InputSecureCode).val("");});}
globalHeader.ShowChangeSmsPlus=function(){showPopupData("Security/ChangeSmsPlus",1);}
globalHeader.ChangeSmsPlus=function(){var txtPhoneNumber=$("#"+itemsId.InputPhoneNumber).val();if(txtPhoneNumber==undefined||txtPhoneNumber.length<10||txtPhoneNumber.length>11||!txtPhoneNumber.startsWith("0")){showMessageError("Số điện thoại không hợp lệ");$("#"+itemsId.InputPhoneNumber).focus();return;}
var otpValue=$("#"+itemsId.InputSecureCode).val();if(otpValue==undefined||otpValue.length!=6){showMessageErrorLevel2('Vui lòng nhập mã xác thực hợp lệ');$("#"+itemsId.InputSecureCode).focus();return;}
var ChangeSmsPlusMobile={PhoneNumberNew:txtPhoneNumber,OtpNewPhone:"",OtpOldPhone:otpValue,Sign:""}
$.ajax({type:"POST",url:configHeader.urlConfig.authenUrl+"Api/AccountSecurity/ChangeSMSPlusMobile",data:ChangeSmsPlusMobile,cache:false,crossDomain:true,xhrFields:{withCredentials:true},success:function(response){if(response.responseCode>0){$("#"+itemsId.InputPhoneNumber).css("display","none");$("#"+itemsId.InputSecureCode).val("");$("#"+itemsId.InputSecureCode).attr("placeholder","Mã OTP SĐT Mới");$("#divConfirmChangeSMS").html('<a class="nutxanhla" href="javascript:void(0);" onclick="GlobalHeader.ChangeSmsPlusStep2()">Xác Nhận</a>')}else{showMessageError(response.description);}}}).always(GlobalHeader.RefreshCaptcha);}
globalHeader.ChangeSmsPlusStep2=function(){var txtPhoneNumber=$("#"+itemsId.InputPhoneNumber).val();if(txtPhoneNumber==undefined||txtPhoneNumber.length<10||txtPhoneNumber.length>11||!txtPhoneNumber.startsWith("0")){showMessageError("Số điện thoại không hợp lệ");$("#"+itemsId.InputPhoneNumber).focus();return;}
var otpValue=$("#"+itemsId.InputSecureCode).val();if(otpValue==undefined||otpValue.length!=6){showMessageErrorLevel2('Vui lòng nhập mã xác thực hợp lệ');$("#"+itemsId.InputSecureCode).focus();return;}
var ChangeSmsPlusMobile={PhoneNumberNew:txtPhoneNumber,OtpNewPhone:otpValue,OtpOldPhone:"",Sign:""}
$.ajax({type:"POST",url:configHeader.urlConfig.authenUrl+"Api/AccountSecurity/ChangeSMSPlusMobile",data:ChangeSmsPlusMobile,cache:false,crossDomain:true,xhrFields:{withCredentials:true},success:function(response){if(response.responseCode>0){$("#"+itemsId.InputPhoneNumber).val("");$("#"+itemsId.InputPhoneNumber).css("display","block");$("#"+itemsId.InputSecureCode).val("");$("#"+itemsId.InputSecureCode).attr("placeholder","Mã OTP SĐT Cũ");$("#divConfirmChangeSMS").html('<a class="btn" onclick="GlobalHeader.ChangeSmsPlus()"><img src="'+configHeader.urlConfig.headerUrl+'Contents/images/btn-dongy.png"></a> ');showMessageError(response.description);}else{showMessageError(response.description);}}}).always(GlobalHeader.RefreshCaptcha);}
globalHeader.ShowUnRegisterSmsPlus=function(){showPopupData("Security/UnRegisterSmsPlus?phoneNumber="+smsPlusMobile,1);}
globalHeader.UnRegisterSmsPlus=function(){var otpValue=$("#"+itemsId.InputSecureCode).val();if(otpValue==undefined||otpValue.length!=6){showMessageErrorLevel2('Vui lòng nhập mã xác thực hợp lệ');$("#"+itemsId.InputSecureCode).focus();return;}
var dataUnverify={Otp:otpValue}
$.ajax({type:"POST",url:configHeader.urlConfig.authenUrl+"api/AccountSecurity/UnVerifyMobileNumber",data:dataUnverify,cache:false,crossDomain:true,xhrFields:{withCredentials:true},success:function(response){if(response.responseCode>0){showMessageError(response.description);setTimeout(function(){GlobalHeader.ClosePopup();GlobalHeader.ShowSecurityInfo();},1500);}else{showMessageError(response.description);}}}).always(GlobalHeader.RefreshCaptcha);}
globalHeader.ShowSetupAuthenSecure=function(){Utils.showLoading();getAjaxInfo(configHeader.urlConfig.authenUrl+"api/AccountSecurity/GetAuthenSecureInfo",function(data){if(data!=undefined&&data.responseCode>0){showPopupData("Security/CancelAuthenSecure",1,1);}else{showPopupData("Security/SetupAuthenSecure",1,1);}});}
globalHeader.SetupAuthenSecure=function(){var data={Type:1}
postAjaxInfo(configHeader.urlConfig.authenUrl+"api/AccountSecurity/SetupAuthenSecure",data,1,function(response){if(response.responseCode>0){showMessageError(response.description);setTimeout(function(){GlobalHeader.ClosePopup();GlobalHeader.ShowSecurityInfo();},1500);}else{showMessageError(response.description);}});}
globalHeader.CancelAuthenSecure=function(){hideMessageError();var otpValue=$("#"+itemsId.InputSecureCode).val();if(otpValue==undefined||otpValue.length!=6){showMessageError('Vui lòng nhập mã xác thực hợp lệ');$("#"+itemsId.InputSecureCode).focus();return;}
var data={Type:2,Otp:otpValue};postAjaxInfo(configHeader.urlConfig.authenUrl+"api/AccountSecurity/SetupAuthenSecure",data,1,function(response){if(response.responseCode>0){showMessageError(response.description);setTimeout(function(){GlobalHeader.ClosePopup();GlobalHeader.ShowSecurityInfo();},1500);}else{showMessageError(response.description);}});}
globalHeader.RegisterTwoFactorAuthen=function(){Utils.showLoading();getAjaxInfo(configHeader.urlConfig.authenUrl+"api/AccountSecurity/TwoFactorAuthGenerateSecretKey",function(data){if(data!=undefined&&data.ResponseStatus>0){location.href=configHeader.urlConfig.headerUrl+"Security/TwoFactorAuthVerifyUser?secretKey="+data.SecretKey;}});}
globalHeader.SetupTwoFactorAuthen=function(){var code=$("#input_twofactor_code").val();if(code==undefined||code.length<6){showMessageError("Mã xác thực không hợp lệ");$("#input_twofactor_code").focus();return;}
Utils.showLoading();$.ajax({type:"GET",url:configHeader.urlConfig.authenUrl+"Api/AccountSecurity/TwoFactorAuthSetup?code="+code,cache:false,crossDomain:true,xhrFields:{withCredentials:true},success:function(response){if(response.ResponseCode>0){showMessageError("Xác thực bảo mật thành công!");}else{showMessageError(response.Description);}}}).always(Utils.hideLoading);}
globalHeader.ShowFreezeUnFreezeBalance=function(){Utils.showLoading();getAjaxInfo(configHeader.urlConfig.authenUrl+"api/BalanceTransaction/GetFreezeStarInfo",function(data){showPopupData("Security/FreezeUnFreezeBalance?balance="+data.StarBalance+"&freezeBalance="+data.FreezeStarBalance,1);});}
globalHeader.FreezeUnFreezeBalance=function(){var freezeValue=Utils.replaceAll($("#"+itemsId.InputFreezeValue).val(),".","");if(freezeValue==undefined||freezeValue<=0){showMessageError('Số tiền không hợp lệ');$("#"+itemsId.InputFreezeValue).focus();return;}
var freezeType=$("#"+itemsId.InputFreezeType).val();var otpValue=$("#"+itemsId.InputSecureCode).val();if(freezeType==2){if(otpValue==undefined||otpValue.length!=6){showMessageError('Vui lòng nhập mã xác thực hợp lệ');$("#"+itemsId.InputSecureCode).focus();return;}}
var data={FreezeType:freezeType,Amount:freezeValue,Otp:otpValue,OtpType:1};postAjaxInfo(configHeader.urlConfig.authenUrl+"api/BalanceTransaction/FreeStar",data,1,function(response){if(response.ResponseCode>0){showMessageError(response.Description);getAjaxInfo(configHeader.urlConfig.authenUrl+"api/BalanceTransaction/GetFreezeStarInfo",function(data){$("#"+itemsId.FreezeRealCoinValue).html(Utils.formatMoney(data.StarBalance));$("#"+itemsId.FreezeFreezeValue).html(Utils.formatMoney(data.FreezeStarBalance));$("#"+itemsId.InputSecureCode).val("");});}else{showMessageError(response.Description);}});}
globalHeader.ShowBlockGameInfo=function(){showPopupData("Security/BlockGameInfo",1);}
globalHeader.BlockGameInfo=function(){hideMessageError();var listServicesChange=[];var isChange=0;var itemsCheckBoxBlockGame=$("#"+itemsId.DivBlockGameInfo).find("input");if(itemsCheckBoxBlockGame!=undefined&&itemsCheckBoxBlockGame.length>0){$.each(itemsCheckBoxBlockGame,function(index,value){var dataChange=$(value).attr("dataChange");if(dataChange>0){isChange=1;var status=0;if($(value).attr("checked")=="checked"){status=1;}
var servicesId=$(value).attr("dataValue");var services={ServiceId:servicesId,Status:status}
listServicesChange.push(services);}});}
if(isChange==0){showMessageError('Lưu dữ liệu thành công!');return;}
var otpValue=$("#"+itemsId.InputSecureCode).val();if(otpValue==undefined||otpValue.length!=6){showMessageError('Vui lòng nhập mã xác thực hợp lệ');$("#"+itemsId.InputSecureCode).focus();return;}
var data={BlockInfo:listServicesChange,OtpValue:otpValue,OtpType:2}
$("#"+itemsId.InputSecureCode).val("");postAjaxInfo(configHeader.urlConfig.authenUrl+"api/AccountSecurity/BlockServices",data,1,function(response){showMessageError(response.Description);});}
globalHeader.ShowUpdateNickName=function(totalUpdate){if(totalUpdate==undefined){totalUpdate=GlobalHeader.TotalUpdateNick;}
showPopupData("Home/UpdateNickName?totalUpdate="+totalUpdate,1);}
globalHeader.UpdateAccountNickName=function(){hideMessageError();var nickNameInput=$("#"+itemsId.InputNickName).val();if(nickNameInput==undefined||nickNameInput.length<4||nickNameInput.length>16){showMessageError("Nickname phải từ 4 đến 16 ký tự");$("#"+itemsId.InputNickName).focus();return;}
getAjaxInfo(configHeader.urlConfig.authenUrl+"api/Account/UpdateNickName?nickName="+
nickNameInput+"&servicesId="+loginInfo.ServiceId+"&continuesUrl="+encodeURIComponent(loginInfo.ContinueUrl)+"&urlRoot="+encodeURIComponent(loginInfo.UrlRoot),function(data){if(data.ResponseCode>0){showMessageError("Cập nhật nickname thành công!");if(gtag&&gtag!==undefined){gtag('event','NRU',{'event_category':'UpdateAccountNickName-Success','event_label':'UpdateAccountNickName Success Campaign'});}
window.location.href=data.RedirectUri;return;}else{if(gtag&&gtag!==undefined){gtag('event','NRU',{'event_category':'UpdateAccountNickName-Fail','event_label':'UpdateAccountNickName Fail Campaign'});}}
Utils.hideLoading();showMessageError(data.Description);});}
globalHeader.showIosDownload=function(){var html='';html+='<div class="frame720 frametaikhoan" style="width: 777px;height: 670px; border: none; left: 25%; background: url('+configHeader.urlConfig.headerUrl+'Contents/images/BG_pios.png) no-repeat top center">';html+='<a class="closein" href="https://i.diawi.com/xqUREY" target="_blank" onclick="GlobalHeader.ClosePopup()"></a>';html+='<div class="noidung baomatsms">';html+='<div class="khungbaomatsms" style=" height: 670px; ">';html+='<div class="nutsms">';html+='<a href="javascript:;" onclick="GlobalHeader.ShowUnRegisterSmsPlus()"><img src=""></a>';html+='</div>';html+='<div class="nutsms">';html+='<a href="javascript:;" onclick="GlobalHeader.ShowSetupAuthenSecure()"><img src=""></a>';html+='</div>';html+='<div class="nutsms">';html+='<a href="javascript:;" onclick="GlobalHeader.ShowFreezeUnFreezeBalance()"><img src=""></a>';html+='</div>';html+='<div class="nutsms">  ';html+='<a href="javascript:;"><img style=" margin: 211px 0 0 143px; " src="'+configHeader.urlConfig.headerUrl+'Contents/images/IOS_icon.png"></a>';html+='</div>';html+='</div>';html+='</div>  ';html+='</div>';showHtmlPopup(html,1);}
globalHeader.ShowUpdateAvatar=function(){showPopupData("Home/UpdateAvatar",1);}
globalHeader.UpdateAccountAvatar=function(){hideMessageError();var avatarId=$("#headerUpdateAvatarId").val();Utils.showLoading();getAjaxInfo(configHeader.urlConfig.authenUrl+"api/Account/UpdateAvatar?avatarId="+avatarId,function(data){if(data.ResponseCode>0){showMessageError("Cập nhật Avatar thành công!");updateAccountHeader();Utils.hideLoading();return;}
Utils.hideLoading();showMessageError(data.Description);});}
globalHeader.ShowUsingTelcoCodeRealCoin=function(){showPopupData("Balance/TopupRealCoin",1);}
globalHeader.ShowUsingTelcoCodePlayCoin=function(cardType){showPopupData("Balance/TopupPlayCoin?cardType="+cardType,1);}
globalHeader.TopupUsingTelcoCode=function(moneyType){hideMessageError();var captCha=$("#"+itemsId.InputCaptchaUser).val();var verify=$("#"+itemsId.CaptchaVerify).val();if(captCha==undefined||captCha.length<3){$("#"+itemsId.InputCaptchaUser).focus();showMessageError("Vui lòng nhập chính xác  mã kiểm tra");return;}
var cardType=$("#"+itemsId.InputCardType).val();if(cardType==undefined||cardType<0){showMessageError("Vui lòng chọn loại thẻ");return;}
var seriCode=$("#"+itemsId.InputCardSerial).val();if(seriCode==undefined||seriCode.length<=4){showMessageError("Vui lòng nhập chính xác serial thẻ");return;}
var cardCode=$("#"+itemsId.InputCardCode).val();if(cardCode==undefined||cardCode.length<=4){showMessageError("Vui lòng nhập chính xác mã thẻ");return;}
if(gtag&&gtag!==undefined){gtag('event','NAU',{'event_category':'NAU click-Success','event_label':'NAU click Campaign'});}
var data={Captcha:captCha,Verify:verify,MoneyType:moneyType,cardType:cardType,seriCode:seriCode,cardCode:cardCode}
$.ajax({type:"POST",url:configHeader.urlConfig.authenUrl+"api/BalanceTransaction/TopupBalanceUseCardTelco",data:data,cache:false,crossDomain:true,xhrFields:{withCredentials:true},success:function(response){if(response.ResponseCode>0){if(gtag&&gtag!==undefined){gtag('event','NAU',{'event_category':'NAU-Success','event_label':'NAU success Campaign'});}
GlobalHeader.UpdateRealCoinBalance(response.AccountBalance);showMessageError(response.Description);updateAccountHeader();}else{if(gtag&&gtag!==undefined){gtag('event','NAU',{'event_category':'NAU - Fail','event_label':'NAU Fail Campaign'});}
showMessageError(response.Description);}}}).always(GlobalHeader.RefreshCaptcha);}
globalHeader.ShowTopupPlayCoinUsingRealCoin=function(){showPopupData("Balance/TopupPlayCoinByRealCoin",1);}
globalHeader.TopupPlayCoinUsingRealCoin=function(){hideMessageError();var captCha=$("#"+itemsId.InputCaptchaUser).val();var giftcode=$("#"+itemsId.InputGiftcode).val();var verify=$("#"+itemsId.CaptchaVerify).val();var exchangeCoin=$("#"+itemsId.InputExchangeCoin).val();exchangeCoin=parseInt(exchangeCoin);if(captCha==''||captCha.length<3){$("#"+itemsId.InputCaptchaUser).focus();showMessageError("Vui lòng nhập chính xác  mã kiểm tra");return;}
var totalXu=exchangeCoin*1000;$("#headerInputXu").val(totalXu);if(exchangeCoin<=0){$("#"+itemsId.InputExchangeCoin).focus();showMessageError("Nhập số Vgold muốn đổi");return;}
var data={Star:exchangeCoin,Captcha:captCha,Verify:verify}
$.ajax({type:"POST",url:configHeader.urlConfig.authenUrl+"Api/BalanceTransaction/TranferStarToCoin",data:data,cache:false,crossDomain:true,xhrFields:{withCredentials:true},success:function(response){console.log(response);if(response.ResponseCode>0){GlobalHeader.UpdateRealCoinBalance(response.Balance);showMessageError(response.Description);updateAccountHeader();}else{showMessageError(response.Description);}}}).always(GlobalHeader.RefreshCaptcha);}
globalHeader.ShowTranferRealCoin=function(nameDaiLy){if(nameDaiLy==undefined){nameDaiLy="";}
Utils.showLoading();getAjaxInfo(configHeader.urlConfig.authenUrl+"api/BalanceTransaction/GetFreezeStarInfo",function(data){showPopupData("Balance/TranferRealCoin?totalBalance="+data.StarBalance,1);setTimeout(function(){$("#headerInputTransferNickName").val(nameDaiLy);$("#headerInputTransferReNickName").val(nameDaiLy);},1000);});}
globalHeader.TranferRealCoinStep1=function(){hideMessageError();if($("#"+itemsId.InputTransferNickName+"_2").is(":visible")){return GlobalHeader.TranferRealCoinStep2();}
var captCha=$("#"+itemsId.InputCaptchaUser).val();var verify=$("#"+itemsId.CaptchaVerify).val();if(captCha==''||captCha.length<3){$("#"+itemsId.InputCaptchaUser).focus();showMessageError("Vui lòng nhập chính xác  mã kiểm tra");return;}
var toUser=$("#"+itemsId.InputTransferNickName).val();var toReUser=$("#"+itemsId.InputTransferReNickName).val();if(toUser==undefined||toUser.length<4){$("#"+itemsId.InputTransferNickName).focus();showMessageError("Tài khoản không hợp lệ");return;}
if(toReUser!=toUser){$("#"+itemsId.InputTransferReNickName).focus();showMessageError("Nhập lại tài khoản không chính xác");return;}
var amount=$("#"+itemsId.InputTransferValue).val();if(amount==undefined&&!Utils.isNumeric(amount)){$("#"+itemsId.InputTransferValue).focus();showMessageError("Số tiền chuyển khoản không hợp lệ");return;}
amount=Utils.replaceAll(amount,".","");var description=$("#"+itemsId.InputTransferDescription).val();var data={Captcha:captCha,VerifyToken:verify,ToUsername:toUser,Amount:amount,DescriptionInfo:description,Odp:''}
$.ajax({type:"POST",url:configHeader.urlConfig.authenUrl+"api/BalanceTransaction/TransferStar",data:data,cache:false,crossDomain:true,xhrFields:{withCredentials:true},success:function(response){if(response.ResponseCode>0){GlobalHeader.ShowTranferRealCoinStep2();$("#headerTransferCaptchaInput_2").val(captCha);showMessageError(response.Description);}
showMessageError(response.Description);}}).always(GlobalHeader.RefreshCaptcha);}
globalHeader.ShowTranferRealCoinStep2=function(){$("#"+itemsId.InputTransferReNickName+"_2").hide();$("#"+itemsId.InputTransferNickName).hide();$("#"+itemsId.InputTransferNickName+"_2").html($("#"+itemsId.InputTransferNickName).val());$("#"+itemsId.InputTransferNickName+"_2").show();$("#"+itemsId.InputTransferValue).hide();$("#"+itemsId.InputTransferValue+"_2").html($("#"+itemsId.InputTransferValue).val());$("#"+itemsId.InputTransferValue+"_2").show();$("#"+itemsId.InputTransferDescription).hide();$("#"+itemsId.InputTransferDescription+"_2").html($("#"+itemsId.InputTransferDescription).val())
$("#"+itemsId.InputTransferDescription+"_2").show();$("#headerDivTransferSecure").hide();$("#headerDivTransferSecureInput").hide();$("#headerTransferNotify").hide();$("#headerDivTransferSecure"+"_2").show();$("#headerDivTransferSecureInput"+"_2").show();$("#headerDivTransferSecureInput"+"_2").focus();}
globalHeader.TranferRealCoinStep2=function(){hideMessageError();var captCha=$("#headerTransferCaptchaInput_2").val();var verify=$("#"+itemsId.CaptchaVerify).val();var toUser=$("#"+itemsId.InputTransferNickName).val();var toReUser=$("#"+itemsId.InputTransferReNickName).val();if(toUser==undefined||toUser.length<4){$("#"+itemsId.InputTransferNickName).focus();showMessageError("Tài khoản không hợp lệ");return;}
if(toReUser!=toUser){$("#"+itemsId.InputTransferReNickName).focus();showMessageError("Nhập lại tài khoản không chính xác");return;}
var amount=$("#"+itemsId.InputTransferValue).val();if(amount==undefined&&!Utils.isNumeric(amount)){$("#"+itemsId.InputTransferValue).focus();showMessageError("Số tiền chuyển khoản không hợp lệ");return;}
var txtOdp=$("#"+itemsId.InputSecureCode).val();if(txtOdp==undefined||txtOdp.length<4){showMessageError("Vui lòng nhập mã ODP");$("#"+itemsId.InputSecureCode).focus();return;}
amount=Utils.replaceAll(amount,".","");var description=$("#"+itemsId.InputTransferDescription).val();var data={Captcha:captCha,VerifyToken:verify,ToUsername:toUser,Amount:amount,DescriptionInfo:description,Odp:txtOdp}
$.ajax({type:"POST",url:configHeader.urlConfig.authenUrl+"api/BalanceTransaction/TransferStar",data:data,cache:false,crossDomain:true,xhrFields:{withCredentials:true},success:function(response){if(response.ResponseCode>0){updateAccountHeader()}
showMessageError(response.Description);}}).always(GlobalHeader.RefreshCaptcha);}
globalHeader.ShowTranferRealCoinStep3=function(){$("#headerDivTransferSecure"+"_2").hide();$("#headerDivTransferSecureInput"+"_2").hide();}
globalHeader.ShowTranferRealCoinSuccess=function(){showPopupData("Home/TranferRealCoinSucces",1);}
globalHeader.ShowUsingGiftcode=function(){showPopupData("Balance/UsingGiftcode",1);}
globalHeader.UsingGiftcode=function(){hideMessageError();var captCha=$("#"+itemsId.InputCaptchaUser).val();var giftcode=$("#"+itemsId.InputGiftcode).val();var verify=$("#"+itemsId.CaptchaVerify).val();if(captCha==''||captCha.length<3){$("#"+itemsId.InputCaptchaUser).focus();showMessageError("Vui lòng nhập chính xác  mã kiểm tra");return;}
if(giftcode==''||giftcode.length<3){$("#"+itemsId.InputCaptchaUser).focus();showMessageError("Vui lòng nhập mã giftcode");return;}
if(gtag&&gtag!==undefined){gtag('event','Nap Giftcode',{'event_category':'Nap Giftcode-click','event_label':'Nap Giftcode click Campaign'});}
var data={Captcha:captCha,GiftCode:giftcode,Verify:verify}
$.ajax({type:"POST",url:configHeader.urlConfig.authenUrl+"api/Account/CheckingGiftCode",data:data,cache:false,crossDomain:true,xhrFields:{withCredentials:true},success:function(response){if(response.ResponseCode>0){if(gtag&&gtag!==undefined){gtag('event','Nap Giftcode',{'event_category':'Nap Giftcode-success','event_label':'Nap Giftcode success Campaign'});}
GlobalHeader.UpdateRealCoinBalance(response.AccountBalance);showMessageError(response.Description);}else{showMessageError(response.Description);if(gtag&&gtag!==undefined){gtag('event','Nap Giftcode',{'event_category':'Nap Giftcode-Fail','event_label':'Nap Giftcode Fail Campaign'});}}}}).always(GlobalHeader.RefreshCaptcha);}
globalHeader.ShowEshop=function(){showPopupData("Balance/Eshop",1);}
globalHeader.EshopExchange=function(){hideMessageError();var captCha=$("#"+itemsId.InputCaptchaUser).val();var verify=$("#"+itemsId.CaptchaVerify).val();if(captCha==''||captCha.length<3){$("#"+itemsId.InputCaptchaUser).focus();showMessageError("Vui lòng nhập chính xác  mã kiểm tra");return;}
var cardType=$("#headerInputCardType").val();var cardId=$("#headerInputCardId").val();var cardValue=$("#headerInputCardValue").val();var balance=$("#headerInputBalanceValue").val();if(cardType==undefined||!(cardType>0)||cardId==undefined||!(cardId>0)){showMessageError("Loại thẻ không hợp lệ");}
Utils.showLoading();$.ajax({type:"GET",crossDomain:true,cache:false,crossDomain:true,xhrFields:{withCredentials:true},url:configHeader.urlConfig.authenUrl+"Api/EshopWebApi/ProcessEshopStep1?captchaText="+captCha+"&captchaVerify="+encodeURI(verify),success:function(data){if(data.ResponseCode>0||data.ResponseCode==-6004){showMessageError("Vui lòng nhập mã ODP đã được gửi về số điện thoại của bạn!");GlobalHeader.ShowEshopStep2(cardType,cardId,cardValue,balance);}else{showMessageError(data.Description);}}}).always(function(){Utils.hideLoading();GlobalHeader.RefreshCaptcha();});}
globalHeader.ShowEshopStep2=function(cardType,cardId,cardValue,balance){showPopupData("Balance/EshopStep2?cardType="+cardType+"&cardId="+cardId+"&cardValue="+cardValue+"&balanceValue="+balance,1);}
globalHeader.EshopExchangeStep2=function(){hideMessageError();var cardType=$("#headerInputCardType").val();var cardId=$("#headerInputCardId").val();if(cardType==undefined||!(cardType>0)||cardId==undefined||!(cardId>0)){showMessageError("Loại thẻ không hợp lệ");return;}
var txtOdp=$("#"+itemsId.InputSecureCode).val();if(txtOdp==undefined||txtOdp.length<4){showMessageError("Vui lòng nhập mã ODP");$("#"+itemsId.InputSecureCode).focus();return;}
Utils.showLoading();$.ajax({type:"GET",crossDomain:true,cache:false,crossDomain:true,xhrFields:{withCredentials:true},url:configHeader.urlConfig.authenUrl+"Api/EshopWebApi/EshopRegisterBuyCardV2?cardType="+cardType+"&cardPrizeId="+cardId+"&quantity=1&odpValue="+txtOdp,success:function(data){showMessageError(data.Description);if(data.ResponseCode==-1021){var cardInfo=data.CardInfo;var cardSerial="";var cardCode="";var cardDatte="";var cardValue=$("#headerEshopMenhGiaTheConfirm").html();if(cardInfo!=null&&cardInfo.length>0&&cardInfo.split(":").length>=3){cardSerial=cardInfo.split(":")[1];cardCode=cardInfo.split(":")[0];cardDatte=cardInfo.split(":")[2];}
GlobalHeader.ShowEshopExchangeDetail(2,0,0,0,function(){var cardText="";if(cardType==1){cardText="Vinaphone";}
if(cardType==2){cardText="Mobiphone";}
if(cardType==3){cardText="Viettel";}
$("#headerCardTypeDetail").html(cardText);$("#headerCardValueDetail").html(cardValue);$("#headerCardSerialDetail").html(cardSerial);$("#headerCardCodeDetail").html(cardCode);$("#headerCardDateDetail").html(cardDatte);});}}}).always(Utils.hideLoading);}
globalHeader.ShowEshopExchangeDetail=function(type,orderId,cardType,cardValue,callback){if(type==2){showPopupData("Balance/EshopOrderDetail?type=2",1,0,callback);}else{Utils.showLoading();$.ajax({type:"GET",url:configHeader.urlConfig.headerUrl+"Balance/EshopOrderDetail?type=1",crossDomain:true,xhrFields:{withCredentials:true},success:function(html){$("#historyExchangeCardDetail").html(html);$("#historyExchangeCardList").hide();$("#historyExchangeCardDetail").show();GlobalHeader.GetEshopExchangeDetail(orderId,cardType,cardValue);}}).always(function(){Utils.hideLoading();});}}
globalHeader.GetEshopExchangeDetail=function(orderId,cardType,cardValue){getAjaxInfo(configHeader.urlConfig.authenUrl+"api/EshopWebApi/GetEshopOrderDetail?orderId="+orderId,function(data){if(data!=undefined&&data.ResponseCode>0){var cardInfo=data.CardInfo;var cardSerial="";var cardCode="";var cardDatte="";if(cardInfo!=null&&cardInfo.length>0&&cardInfo.split(":").length>=3){cardSerial=cardInfo.split(":")[1];cardCode=cardInfo.split(":")[0];cardDatte=cardInfo.split(":")[2];}
var cardText="";if(cardType==1){cardText="Vinaphone";}
if(cardType==2){cardText="Mobiphone";}
if(cardType==3){cardText="Viettel";}
$("#headerCardTypeDetail").html(cardText);$("#headerCardValueDetail").html(Utils.formatMoney(cardValue));$("#headerCardSerialDetail").html(cardSerial);$("#headerCardCodeDetail").html(cardCode);$("#headerCardDateDetail").html(new Date(cardDatte).yyyymmdd());}});}
globalHeader.BindEshopHistoryList=function(currPage,recordPerPage){getAjaxInfo(configHeader.urlConfig.authenUrl+"api/EshopWebApi/GetListTopupHistory?currPage="+
currPage+"&recordPerPage="+recordPerPage+"&fromDate=01-01-1998&toDate=01-01-2200",function(data){if(data!=undefined&&data.TotalRecord>0){var html=""
$.each(data.ListOrder,function(key,val){html+='<tr>'+
'    <td>'+new Date(val.CreatedTime).yyyymmddHHmmss()+'</td>'+
'    <td>'+val.CardName+'</td>'+
'    <td>'+Utils.formatMoney(val.CardPrizeValue)+'</td>'+
'    <td>'+Utils.formatMoney(val.StarValue)+'</td>'+
'    <td>'+GlobalHeader.GetStatusCard(val.Status)+'</td>';if(val.Status==1){html+='    <td><a class="nutxanhlanho" href="javascript:;" onclick="GlobalHeader.ShowEshopExchangeDetail(1,'+val.Id+','+val.CardId+','+val.CardPrizeValue+');">CHI TIẾT</a></td>'}else{html+="<td></td>";}
html+='</tr>';});$("#headerHistoryEshop").html(html);var page=data.TotalRecord/recordPerPage
if(data.TotalRecord%recordPerPage>0){page+=1;}
$('#headerHistoryPaging').pager({pagenumber:currPage,pagecount:page,buttonClickCallback:function(page){GlobalHeader.BindEshopHistoryList(page,10);}});}});}
globalHeader.GetStatusCard=function(status){var statusDetail="";if(status==1){statusDetail='Đã Duyệt';}else if(status==0){statusDetail='Chờ duyệt';}else if(status==4){statusDetail='Chờ mua thẻ';}else if(status==5){statusDetail='Chờ mua thẻ';}
else{statusDetail='Đã hủy';}
return statusDetail;}
globalHeader.CopyCardSerial=function(){}
globalHeader.CopyCardCode=function(){}
globalHeader.HideEshopExchangeDetail=function(){if($("#historyExchangeCardList").length>0){$("#historyExchangeCardList").show();$("#historyExchangeCardDetail").html("");}else{GlobalHeader.ShowExchangeHistory();}}
globalHeader.ShowExchangeVipItem=function(){showPopupData("Balance/ExchangeVipItem",1);}
globalHeader.ShowExchangeVipItemConfirm=function(){showHtmlPopupLevel2();}
globalHeader.ShowExchangeVipItemInput=function(){showPopupData("Balance/ExchangeVipInput",1);}
globalHeader.ExchangeVipItemInput=function(){showHtmlPopupLevel2();}
globalHeader.ShowExchangeHistory=function(type){if(type==undefined||!(type>0)){type=1;}
showPopupData("Balance/ExchangeHistory?type="+type,1,0,function(){if(type==1){GlobalHeader.BindEshopHistoryList(1,10);}});}
globalHeader.ExchangeHistory=function(){hideMessageError();}
globalHeader.ShowBalanceHistory=function(type){if(type==undefined||!(type>=0)){type=0;}
showPopupData("Home/BalanceHistory?type="+type,1,0,function(){GlobalHeader.BindBalanceHistoryList(type,1,10);});}
globalHeader.BindBalanceHistoryList=function(type,currPage,recordPerPage){getAjaxInfo(configHeader.urlConfig.authenUrl+"Api/Account/GetAccountHistory?gameId=0&choose="+type+"&logType=1&page="+
currPage+"&recordPerPage="+recordPerPage,function(data){if(data!=undefined&&data.TotalRecord>0){var html=""
$.each(data.Histories,function(key,val){html+='<tr><td>'+new Date(val.CreatedTime).yyyymmddHHmmss()+'</td>';html+='<td>'+val.ServiceName+'</td>';var sign='';if(parseFloat(val.Amount)>=0){sign='+';}
else{sign='-';}
html+='<td>'+sign+'</td><td>'+Utils.formatMoney(Math.abs(val.Amount))+'</td>';html+='<td>'+Utils.formatMoney(val.BalanceAfter)+'</td>';html+='<td>'+val.Description+'</td>';html+='</tr>';});$("#headerBalanceHistory").html(html);var page=data.TotalRecord/recordPerPage
if(data.TotalRecord%recordPerPage>0){page+=1;}
$('#headerHistoryPaging').pager({pagenumber:currPage,pagecount:page,buttonClickCallback:function(page){GlobalHeader.BindBalanceHistoryList(type,page,10);}});}});}
globalHeader.ShowLoyalty=function(type){return;if(type==undefined||!(type>0)){type=1;}
showPopupData("Loyalty/Main?type="+type,1);}
globalHeader.ShowAccountInfo=function(){showPopupData("Home/AccountInfo",1);setTimeout(function(){var totalMail=parseInt($("#headerMailTotal").html());if(totalMail>0){$("#mail_MailTotal").css("display","block");}
$("#mail_MailTotal").html($("#headerMailTotal").html());},200);}
globalHeader.ShowMail=function(){var totalMail=parseInt($("#headerMailTotal").html());if(totalMail>0){$("#mail_MailTotal").css("display","block");}
$("#mail_MailTotal").html($("#headerMailTotal").html());showPopupData("Home/ShowMail",1);GlobalHeader.BindMailList(1);setTimeout(function(){$("#style-1").mCustomScrollbar();$("#noidungmail").mCustomScrollbar();},200)}
globalHeader.BindMailList=function(){var link="Api/Account/GetListAccountGift";var id=0;getAjaxInfo(configHeader.urlConfig.authenUrl+link,function(data){if(data!=undefined){var html=""
$.each(data,function(key,val){var title=val.Title;if(val.Title.length>15){title=val.Title.substring(0,15);title+="...";}
id=val.InventoryID;if(val.Status>0){html+='<div class="khungtieude dadoc" onclick="GlobalHeader.MailDetail('+id+', this)">';html+='<p>'+new Date(val.CreatedDate).yyyymmddHHmmss()+'</p>';html+='<p>'+title+'</p>';html+='</div>';}
else{html+='<div class="khungtieude" onclick="GlobalHeader.MailDetail('+id+', this)">';html+='<p>'+new Date(val.CreatedDate).yyyymmddHHmmss()+'</p>';html+='<p>'+title+'</p>';html+='<p class="notiblue">NEW</p>';html+='</div>';}});$("#style-1").html(html);}});}
globalHeader.MailDetail=function(id,_this){var link="";GlobalHeader.getCurrentMail();if(id==undefined||id<1){return;}
else{if($(_this).attr("class").indexOf("dadoc")>-1){}
else{$(_this).addClass("dadoc");}
link="Api/Account/GetGiftDetail?inventoryId="+id;getAjaxInfo(configHeader.urlConfig.authenUrl+link,function(data){if(data!=undefined){var html=""
var img="";if(data.TotalMoneyPaid>=data.TotalMoney){img="confirm.png";}
else{img="cancel.png";}
html+='<p>'+data.Title;html+='</p>';html+='<br>';html+='<div>';html+='<p>điều kiện nhận giải:</p> <br>';html+='<p>';html+='+Luồng tiền: <span style="color: #0effff; font-weight: bold; ">'+data.TotalMoneyPaid+'</span>/<span style="color: #02c302; font-weight: bold;">'+data.TotalMoney+'<img style=" width: 25px; " src="'+configHeader.urlConfig.headerUrl+'Contents/images/'+img+'"></span>';html+='</p>';html+='</div>';html+='<br>';if(data.Status<1){html+='<a class="nutxanhlavua" onclick="GlobalHeader.MailReceivePrize('+id+')" >Nhận Ngay</a>';}
else{html+='<a class="nutxanhlavua" onclick="" >Đã Nhận</a>';}
$("#noidungmail").html(html);}});}}
globalHeader.MailReceivePrize=function(id){$.ajax({type:"GET",url:configHeader.urlConfig.authenUrl+"Api/Account/ReceiveRewardGift?inventoryId="+id,crossDomain:true,xhrFields:{withCredentials:true},success:function(data){GlobalHeader.PopupMessage(data.Description);if(data.ResponseStatus>0){GlobalHeader.UpdateRealCoinBalance(data.Balance);}}}).always(function(){Utils.hideLoading();});}
globalHeader.getCurrentMail=function(){$.ajax({type:"GET",url:configHeader.urlConfig.authenUrl+"Api/Account/GetTotalGiftLeft",crossDomain:true,xhrFields:{withCredentials:true},success:function(data){if(data>0){$("#headerMailTotal").css("display","block");$("#mail_MailTotal").css("display","block");}
$("#headerMailTotal").html(data);$("#mail_MailTotal").html(data);}}).always(function(){Utils.hideLoading();});}
globalHeader.PopupMessage=function(content){var html='';html+='<div class="blackscreen2" id="headerOverlayPopupLevel2" style="">></div>';html+='<div class="popup2" id="headerContentPopupLevel2" style="">';html+='<div class="frame pophoi popthanhcong">';html+='<div class="noidung">';html+='<div class="row">';html+='<p>'+content+'</p>';html+='</div>';html+='<div class="row">';html+='<a class="button" href="javascript:void(0);" onclick="GlobalHeader.ClosePopupLevel2()"><img src="'+configHeader.urlConfig.headerUrl+'Contents/images/btn-dongy.png"></a>';html+='</div>';html+='</div>';html+='</div>';html+='</div>';$("#popupMessageLevel2").html(html);}
globalHeader.ShowListSeller=function(){showPopupData("Balance/ListSeller",1);}
globalHeader.RefreshCaptcha=function(){$.ajax({type:"GET",url:configHeader.urlConfig.authenUrl+"Api/Captcha/Get?length=3",success:function(captchaData){if(captchaData!=undefined){$("#"+itemsId.CaptchaImg).attr("src","data:image/jpeg;base64,"+captchaData[1]+"");$("#"+itemsId.CaptchaVerify).val(captchaData[0]);$("#"+itemsId.InputCaptchaUser).val("");$("#"+itemsId.DivCaptcha).show();}}});}
globalHeader.ClosePopup=function(){Utils.closeOverlayPopup();$("#"+itemsId.ContentPopup).html("");}
globalHeader.ClosePopupLevel2=function(){$("#"+itemsId.OverlayPopupLevel2).hide();$("#"+itemsId.ContentPopupLevel2).hide();hideMessageErrorLevel2();}
globalHeader.ShowCurrentEvent=function(type){if(type==undefined||!(type>0)){type=1;}
showPopupData("Home/CurentEvents?type="+type,1);}
function getAjaxInfo(url,callback){$.ajax({type:"GET",url:url,cache:false,crossDomain:true,xhrFields:{withCredentials:true},success:function(response){if(callback!=undefined&&typeof callback==="function")
callback(response);}});}
function postAjaxInfo(url,data,showLoading,callback){if(showLoading>0){Utils.showLoading();}
$.ajax({type:"POST",url:url,data:data,cache:false,crossDomain:true,xhrFields:{withCredentials:true},success:function(response){if(callback!=undefined&&typeof callback==="function")
callback(response);}}).always(function(){if(showLoading>0){Utils.hideLoading();}});}
function showPopupData(dataView,isOverlay,hideLoading,callback){if(!hideLoading>0){Utils.showLoading();}
$.ajax({type:"GET",url:configHeader.urlConfig.headerUrl+dataView,crossDomain:true,xhrFields:{withCredentials:true},success:function(html){showHtmlPopup(html,isOverlay);if(callback!=undefined&&typeof callback==="function")
callback();}}).always(function(){Utils.hideLoading();});}
function showMessageError(description){$("#"+itemsId.ErrorMessage).html(description);$("#"+itemsId.ErrorDivMessage).show();}
function hideMessageError(){$("#"+itemsId.ErrorMessage).html("");$("#"+itemsId.ErrorDivMessage).hide();}
function showMessageErrorLevel2(description){$("#"+itemsId.ErrorMessageLevel2).html(description);$("#"+itemsId.ErrorDivMessageLevel2).show();}
function hideMessageErrorLevel2(){$("#"+itemsId.ErrorMessageLevel2).html("");$("#"+itemsId.ErrorDivMessageLevel2).hide();}
function showHtmlPopup(html,isOverlay){if(isOverlay==undefined){isOverlay=1;}
if(isOverlay>0){Utils.showOverlayPopup("");}
$("#"+itemsId.ContentPopup).html(html);}
function showHtmlPopupLevel2(){$("#"+itemsId.OverlayPopupLevel2).show();$("#"+itemsId.ContentPopupLevel2).show();}
function addGaInfo(){var utm_campaign=getParameterByName('utm_campaign',window.location.href);if(utm_campaign==undefined||utm_campaign===''){utm_campaign="Tracking";}
if(parseInt(getParameterByName("LoginGoogle",window.location.href))>0){if(gtag&&gtag!==undefined){gtag('event','LoginGoogle',{'event_category':'LoginGoogle-Success','event_label':utm_campaign});}
history.pushState({},'',window.location.href.replace("?LoginGoogle=1","").replace("&LoginGoogle=1",""));}
if(parseInt(getParameterByName("LoginFacebook",window.location.href))>0){if(gtag&&gtag!==undefined){gtag('event','LoginFacebook',{'event_category':'LoginFacebook-Success','event_label':utm_campaign});}
history.pushState({},'',window.location.href.replace("?LoginFacebook=1","").replace("&LoginFacebook=1",""));}
if(parseInt(getParameterByName("RegisterFacebook",window.location.href))>0){if(gtag&&gtag!==undefined){gtag('event','RegisterFacebook',{'event_category':'RegisterFacebook-Success','event_label':utm_campaign});}
history.pushState({},'',window.location.href.replace("?RegisterFacebook=1","").replace("&RegisterFacebook=1",""));}
if(parseInt(getParameterByName("RegisterFailFacebook",window.location.href))>0){if(gtag&&gtag!==undefined){gtag('event','RegisterFacebook',{'event_category':'RegisterFacebook-Fail','event_label':utm_campaign});}
history.pushState({},'',window.location.href.replace("?RegisterFailFacebook=1","").replace("&RegisterFailFacebook=1",""));}
if(parseInt(getParameterByName("RegisterGoogle",window.location.href))>0){if(gtag&&gtag!==undefined){gtag('event','RegisterGoogle',{'event_category':'RegisterGoogle-Success','event_label':utm_campaign});}
history.pushState({},'',window.location.href.replace("?RegisterGoogle=1","").replace("&RegisterGoogle=1",""));}
if(parseInt(getParameterByName("RegisterFailGoogle",window.location.href))>0){if(gtag&&gtag!==undefined){gtag('event','RegisterGoogle',{'event_category':'RegisterGoogle-Fail','event_label':utm_campaign});}
history.pushState({},'',window.location.href.replace("?RegisterFailGoogle=1","").replace("&RegisterFailGoogle=1",""));}};function getParameterByName(name,url){if(!url)url=window.location.href;name=name.replace(/[\[\]]/g,"\\$&");var regex=new RegExp("[?&]"+name+"(=([^&#]*)|&|#|$)"),results=regex.exec(url);if(!results)return null;if(!results[2])return '';return decodeURIComponent(results[2].replace(/\+/g," "));}
return globalHeader;})($);(function(){var minigameLoadConfig={'Portal':{MiniPoker:{Load:true,Show:true},MiniLongPhung:{Load:true,Show:true},MiniLuckyDice:{Load:true,Show:true},MiniThienHa:{Load:true,Show:true}},'vuaphattai':{MiniPoker:{Load:true,Show:true},MiniLongPhung:{Load:true,Show:true},MiniLuckyDice:{Load:true,Show:true},MiniThienHa:{Load:true,Show:true}},'avenger':{MiniPoker:{Load:true,Show:true},MiniLongPhung:{Load:true,Show:true},MiniLuckyDice:{Load:true,Show:true},MiniThienHa:{Load:true,Show:true}}}
var maintainUrl='';var minigameConfigs={MiniPoker:{GameId:1,Urls:commonLoadMinigameUrls.MiniPoker,SuccessCallback:function(isShow){MiniPokerGame=new window.MiniPokerLogic(isShow);},Default:{Load:true,Show:true,ShowTime:0,InMaintain:false,CheckFirst:false},Event:{day:[3]}},MiniLongPhung:{GameId:2,Urls:commonLoadMinigameUrls.MiniLongPhung,SuccessCallback:function(isShow){LongPhungGame.ShowHide(isShow);},Default:{Load:true,Show:true,ShowTime:0,InMaintain:false,CheckFirst:false}},MiniLuckyDice:{GameId:3,Urls:commonLoadMinigameUrls.MiniLuckyDice,SuccessCallback:function(isShow){LuckyDiceGame=new window.LuckyDiceLogic();LuckyDiceGame.initLuckyDice(isShow);},Default:{Load:true,Show:true,ShowTime:0,InMaintain:false,CheckFirst:false}},MiniThienHa:{GameId:3,Urls:commonLoadMinigameUrls.MiniThienHa,SuccessCallback:function(isShow){ThienHaGame=new window.ThienHaGame();if(isShow){ThienHaGame.showHide();}},Default:{Load:true,Show:true,ShowTime:0,InMaintain:false,CheckFirst:false}}};var loadedJs={};var timeOffset;function commonLoadMinigame(autoLoading){if(autoLoading){this.LoadMinigames();}}
commonLoadMinigame.prototype.LoadMinigames=function(){var pageConfig=minigameLoadConfig[getSiteName()];if(!pageConfig)return;$('<div id="minigames_wrapper" style=" position: absolute;z-index:1 "></div>').appendTo('#headerDivScale');var dateInt=new Date().toISOString().substr(0,10).replace(/\-/g,'');var keyFirstLoad='LoadMinigame_PL_'+dateInt+'_'+GlobalHeader.AccountId;var firstLoadMinigame=localStorage.getItem(keyFirstLoad);for(var gameName in minigameConfigs){if(pageConfig[gameName]==null)pageConfig[gameName]={};pageConfig[gameName]=$.extend({},minigameConfigs[gameName].Default,pageConfig[gameName]);if(firstLoadMinigame!=null&&pageConfig[gameName].CheckFirst){pageConfig[gameName].Show=false;}}
localStorage.setItem(keyFirstLoad,true);for(var loadgameName in pageConfig){loadGame(loadgameName,pageConfig[loadgameName]);}};function checkMaintainMinigame(callback){$.get(maintainUrl).done(function(data){if(data.ListGameMaintain!=null){var listGameId={};for(var gameName in minigameConfigs){if(minigameConfigs[gameName].GameId){listGameId[minigameConfigs[gameName].GameId]=gameName;}}
timeOffset=new Date()-new Date(data.CurrentDate);data.ListGameMaintain.forEach(function(maintainGame){if(listGameId[maintainGame.GameID]){$.extend(minigameConfigs[listGameId[maintainGame.GameID]].Default,{InMaintain:true,FromDate:maintainGame.FromDate,ToDate:maintainGame.ToDate});}});}
callback&&callback();});}
function getSiteName(){if(window.location.href.toLowerCase().indexOf('portal')>-1||window.location.href=='http://localhost:3575/'||window.location.href.split(/\?|#/)[0]==configHeader.urlConfig.headerUrl)
return 'Portal';for(var subdomain in minigameLoadConfig){if(window.location.href.toLowerCase().indexOf('/'+subdomain)>-1)return subdomain;}
return '';}
function checkShowMinigame(gameName,config){var event=minigameConfigs[gameName].Event;if(event){var now=new Date();if(event.hour&&!event.hour.indexOf(now.getHours())>-1)return config.Show;if(event.day.indexOf(now.getDay())>-1)return true;}
return config.Show;}
function loadGame(gameName,config){if(!config.Load)return;if(config.InMaintain){var currDate=new Date();var fromDate=new Date(config.FromDate);var toDate=new Date(config.ToDate);if(currDate-timeOffset>fromDate&&currDate-timeOffset<toDate)return;}
$.loadMultiScripts(minigameConfigs[gameName].Urls,function(){loadedJs[gameName]=true;var isShow=checkShowMinigame(gameName,config);if(isShow&&config.ShowTime>0){setTimeout(minigameConfigs[gameName].SuccessCallback.bind(null,isShow),config.ShowTime);}else{minigameConfigs[gameName].SuccessCallback(isShow);}});}
commonLoadMinigame.prototype.LoadGame=function(gameName){if(loadedJs[gameName]){return;}
var config={Load:true,Show:true,ShowTime:0};loadGame(gameName,config);};commonLoadMinigame.prototype.CheckLoadedJs=function(gameName){return loadedJs[gameName]==true;};window.CommonLoadMinigame=commonLoadMinigame;})()
var JackpotInfoHome=(function(){var timeUpdateJackpot=15000;var jackpotInfoHome={};jackpotInfoHome.Init=function(){setInterval(function(){jackpotInfoHome.LoadAllJackpot();},timeUpdateJackpot);this.LoadAllJackpot();}
jackpotInfoHome.LoadAllJackpot=function(){for(var bb=1;bb<4;bb++){var betValue=0;switch(bb){case 1:betValue=100;playCountUp(betValue);break;case 2:betValue=1000;playCountUp(betValue);break;case 3:betValue=10000;playCountUp(betValue);break;}
function playCountUp(betValue){$.ajax({type:"GET",url:configHeader.urlConfig.eventUrl+
'api/JackpotInfoApi/ListJackpotInfo?BetValue='+
betValue+
'&TopCount='+
5,crossDomain:true,xhrFields:{withCredentials:true},cache:false,success:function(data){if(data!=null&&data.length>0){var l=data.length;var html='';var jpValue=[];for(var i=0;i<l;i++){var numstart=data[i].Jackpot-100000;if(numstart!=""&&numstart<=data[i].Jackpot){numstart=numstart;}else{numstart=data[i].Jackpot-100000;}
var options={useEasing:true,useGrouping:true,separator:'.',decimal:'.',prefix:'',suffix:''};var demo=new CountUp_Header("jp_prizevalue_home_"+betValue+"_"+data[i].GameIcon,numstart,data[i].Jackpot,0,12,options);var demo2=new CountUp_Header("jp_prizevalue_home2_"+betValue+"_"+data[i].GameIcon,numstart,data[i].Jackpot,0,12,options);var demo3=new CountUp_Header("jp_prizevalue_home3_"+betValue+"_"+data[i].GameIcon,numstart,data[i].Jackpot,0,12,options);demo.start();demo2.start();demo3.start();}}},fail:function(){console.log('data not found');}});}}}
jackpotInfoHome.ParseMoney=function(money){if(money==undefined)return '';var strMoney=money.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")
return strMoney;}
return jackpotInfoHome;})(window);var JackPotInfo=(function(){var timeUpdateJackpot=15000;var jackpotInfo={};jackpotInfo.betValue=10000;jackpotInfo.SetBetValue=function(value){JackPotInfo.betValue=value;}
jackpotInfo.Init=function(){setInterval(function(){if($('#headerContentJp').is(":visible")){JackPotInfo.LoadNewData();}},timeUpdateJackpot);this.LoadNewData();}
jackpotInfo.LoadNewData=function(){$.ajax({type:"GET",url:configHeader.urlConfig.eventUrl+
'api/JackpotInfoApi/ListJackpotInfo?BetValue='+
JackPotInfo.betValue+
'&TopCount='+
5,crossDomain:true,xhrFields:{withCredentials:true},cache:false,success:function(data){if(data!=null&&data.length>0){var l=data.length;var html='';var jpValue=[];for(var i=0;i<l;i++){if(data[i].GameIcon=='thienha'){html+='<div onclick="ThienHaGame.showHide();" class="hufapgame">';}else if(data[i].GameIcon=='minipoker'){html+='<div onclick="MiniPokerGame.showHideGame();"  class="hufapgame">';}else if(data[i].GameIcon=='longphung'){html+='<div onclick="LongPhungGame.ShowHide(true);"  class="hufapgame">';}else{html+='<div  class="hufapgame" onclick="window.open(\''+
data[i].GameUrl+
'\', \'_blank\')">';}
html+='<img src="'+
configHeader.urlConfig.headerUrl+
'Contents/images/ListJp/'+
data[i].GameIcon+
'.png" />';html+='<div class="info"><p class="ten">'+
data[i].GameName+
'</p><p class="tien" id="jp_prizevalue_'+
i+
'">0</p>'+
'</div>';html+='</div>';jpValue.push(data[i].Jackpot);}
$('#headerContentJp').html(html);for(var i=0;i<l;i++){var numstart=data[i].Jackpot-100000;if(numstart!=""&&numstart<=data[i].Jackpot){numstart=numstart;}else{numstart=data[i].Jackpot-100000;}
var options={useEasing:true,useGrouping:true,separator:'.',decimal:'.',prefix:'',suffix:''};var demo=new CountUp_Header("jp_prizevalue_"+i,numstart,data[i].Jackpot,0,12,options);demo.start();}}},fail:function(){console.log('data not found');}});}
jackpotInfo.ParseMoney=function(money){if(money==undefined)return '';var strMoney=money.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")
return strMoney;}
return jackpotInfo;})(window);var CountUp_Header=function(target,startVal,endVal,decimals,duration,options,callback){var lastTime=0;var vendors=['webkit','moz','ms','o'];for(var x=0;x<vendors.length&&!window.requestAnimationFrame;++x){window.requestAnimationFrame=window[vendors[x]+'RequestAnimationFrame'];window.cancelAnimationFrame=window[vendors[x]+'CancelAnimationFrame']||window[vendors[x]+'CancelRequestAnimationFrame'];}
if(!window.requestAnimationFrame){window.requestAnimationFrame=function(callback,element){var currTime=new Date().getTime();var timeToCall=Math.max(0,16-(currTime-lastTime));var id=window.setTimeout(function(){callback(currTime+timeToCall);},timeToCall);lastTime=currTime+timeToCall;return id;};}
if(!window.cancelAnimationFrame){window.cancelAnimationFrame=function(id){clearTimeout(id);};}
this.options={useEasing:true,useGrouping:true,separator:',',decimal:'.'};for(var key in options){if(options.hasOwnProperty(key)){this.options[key]=options[key];}}
if(this.options.separator==='')this.options.useGrouping=false;if(!this.options.prefix)this.options.prefix='';if(!this.options.suffix)this.options.suffix='';this.d=(typeof target==='string')?document.getElementById(target):target;this.startVal=Number(startVal);if(isNaN(startVal))this.startVal=Number(startVal.match(/[\d]+/g).join(''));this.endVal=Number(endVal);if(isNaN(endVal))this.endVal=Number(endVal.match(/[\d]+/g).join(''));this.countDown=(this.startVal>this.endVal);this.frameVal=this.startVal;this.decimals=Math.max(0,decimals||0);this.dec=Math.pow(10,this.decimals);this.duration=Number(duration)*1000||2000;var self=this;this.version=function(){return '1.5.3';};this.printValue=function(value){if(callback){callback(value);}
$(this.d).html(this.fomatMoney(value));};this.fomatMoney=function(money){if(money==undefined)return '';var strMoney=money.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".");return strMoney;}
this.easeOutExpo=function(t,b,c,d){return c*(-Math.pow(2,-10*t/d)+1)*1024/1023+b;};this.count=function(timestamp){if(!self.startTime)self.startTime=timestamp;self.timestamp=timestamp;var progress=timestamp-self.startTime;self.remaining=self.duration-progress;if(self.options.useEasing){if(self.countDown){self.frameVal=self.startVal-self.easeOutExpo(progress,0,self.startVal-self.endVal,self.duration);}else{self.frameVal=self.easeOutExpo(progress,self.startVal,self.endVal-self.startVal,self.duration);}}else{if(self.countDown){self.frameVal=self.startVal-((self.startVal-self.endVal)*(progress/self.duration));}else{self.frameVal=self.startVal+(self.endVal-self.startVal)*(progress/self.duration);}}
if(self.countDown){self.frameVal=(self.frameVal<self.endVal)?self.endVal:self.frameVal;}else{self.frameVal=(self.frameVal>self.endVal)?self.endVal:self.frameVal;}
self.frameVal=Math.round(self.frameVal*self.dec)/self.dec;self.printValue(self.frameVal);if(progress<self.duration){self.rAF=requestAnimationFrame(self.count);}else{if(self.callback)self.callback();}};this.start=function(callback){self.callback=callback;if(!isNaN(self.endVal)&&!isNaN(self.startVal)&&self.startVal!==self.endVal){self.rAF=requestAnimationFrame(self.count);}else{self.printValue(endVal);}
return false;};this.pauseResume=function(){if(!self.paused){self.paused=true;cancelAnimationFrame(self.rAF);}else{self.paused=false;delete self.startTime;self.duration=self.remaining;self.startVal=self.frameVal;requestAnimationFrame(self.count);}};this.reset=function(){self.paused=false;delete self.startTime;self.startVal=startVal;cancelAnimationFrame(self.rAF);self.printValue(self.startVal);};this.update=function(newEndVal){cancelAnimationFrame(self.rAF);self.paused=false;delete self.startTime;self.startVal=self.frameVal;self.endVal=Number(newEndVal);self.countDown=(self.startVal>self.endVal);self.rAF=requestAnimationFrame(self.count);};this.formatNumber=function(nStr){nStr=nStr.toFixed(self.decimals);nStr+='';var x,x1,x2,rgx;x=nStr.split('.');x1=x[0];x2=x.length>1?self.options.decimal+x[1]:'';rgx=/(\d+)(\d{3})/;if(self.options.useGrouping){while(rgx.test(x1)){x1=x1.replace(rgx,'$1'+self.options.separator+'$2');}}
return self.options.prefix+x1+x2+self.options.suffix;};self.printValue(self.startVal);};Date.prototype.yyyymmdd=function(){var mm=this.getMonth()+1;var dd=this.getDate();return[this.getFullYear(),(mm>9?'':'0')+mm,(dd>9?'':'0')+dd].join('-');};Date.prototype.yyyymmddHHmmss=function(){var mm=this.getMonth()+1;var dd=this.getDate();var hour=this.getHours();var minute=this.getHours();var second=this.getHours();var currdate=[this.getFullYear(),(mm>9?'':'0')+mm,(dd>9?'':'0')+dd].join('-');var time=[(hour>9?'':'0')+hour,(minute>9?'':'0')+minute,(second>9?'':'0')+second,].join(":");return currdate+" "+time;};