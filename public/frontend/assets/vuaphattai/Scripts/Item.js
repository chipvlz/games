(function(scope,$){var config=new scope.Config();var scaleSpin=0.5;var library=new scope.Lib();var item=function(){};item.prototype.drawItem=function(number){var container=vqsSlot.containerItem;if(number==97||number==0){for(var i=0;i<3;i++){for(var k=0;k<5;k++){var itemImg=new createjs.Sprite(vqsSlot.SpriteSheetItem);var iconId=vqsSlot.oldListItem[i*5+k];itemImg.gotoAndStop("Icon_"+iconId);itemImg.set({name:k+'imgItem'+(number+i),regX:itemImg.getBounds().width/2,regY:itemImg.getBounds().height/2,scaleX:0.9,scaleY:0.9,y:(number+i)*config.ContainerXY.sizeY-8});itemImg.cache(0,0,140,140);container.getChildAt(k).addChild(itemImg);}}}else{for(var i=0;i<5;i++){for(var j=3;j<97;j++){var rdNumber=Math.floor(Math.random()*7);var itemImg1=new createjs.Sprite(vqsSlot.SpriteSheetItem);itemImg1.gotoAndStop("Icon_"+rdNumber+"S");itemImg1.set({name:i+'imgItem'+(number+j),regX:itemImg1.getBounds().width/2,regY:itemImg1.getBounds().height/2,scaleX:0.9,scaleY:0.9,y:(j==3)?(j*config.ContainerXY.sizeY-10):(j*config.ContainerXY.sizeY-8)});itemImg1.cache(0,0,140,140);container.getChildAt(i).addChild(itemImg1);}}}};item.prototype.runSpin=function(result,callback){setTimeout(function(){vqsSlot.playSound("spin");},300);var container=vqsSlot.containerItem;for(var i=0;i<5;i++){container.getChildAt(i).removeAllChildren();}
this.drawItem(97);this.drawItem(9);vqsSlot.oldListItem=result;this.drawItem(0);var toaDoY=config.ContainerXY.Y-config.ContainerXY.sizeY*97;var toaDoYEnd=config.ContainerXY.Y-60;var toaDoYEnd1=config.ContainerXY.Y-30;var listCoontainer=[0,1,2,3,4];listCoontainer.sort(function(a,b){return 0.5-Math.random();});var timeEff=500;var downDown=2000;var upDown=50;var upDown1=40;var timeNext=timeEff*5+2*upDown+2*upDown1+downDown+600;listCoontainer.forEach(function(k){container.getChildAt(listCoontainer[k]).set({y:toaDoY});createjs.Tween.get(container.getChildAt(listCoontainer[k]),{loop:false,override:true}).wait(k*timeEff).to({x:config.ContainerXY.X[listCoontainer[k]],y:config.ContainerXY.Y,alpha:1},downDown,createjs.Ease.bounceOut).call(function(){vqsSlot.playSound("stop-line");for(var n=96;n>-1;n--){container.getChildAt(listCoontainer[k]).removeChildAt(n);}}).to({y:toaDoYEnd,alpha:1},upDown,createjs.Ease.bounceOut).to({y:config.ContainerXY.Y,alpha:1},upDown,createjs.Ease.bounceOut).to({y:toaDoYEnd1,alpha:1},upDown1,createjs.Ease.bounceOut).to({y:config.ContainerXY.Y,alpha:1},upDown,createjs.Ease.bounceOut);});setTimeout(function(){if(typeof callback!='undefined'&&typeof callback=='function')
callback();},timeNext);};item.prototype.runStarWinNew=function(money,countStar,callback){var that=this;var timeEffect=600,timeSmall=8;var countRun=timeEffect/timeSmall;var timeNext=(countStar/2)*18+timeEffect+10;if(money!=-1){setTimeout(function(){vqsSlot.containerMoney.removeAllChildren();if(typeof callback!='undefined'&&typeof callback=='function')
callback();},timeNext);}
function runTimeSmall(count,iconRun,tdx,tdy,val,sttStar){createjs.Tween.get(iconRun,{loop:false}).to({x:val*count*2*tdx/countRun,y:getParabolY(count*2*tdx/countRun,tdx,tdy)},timeSmall);var timeDelay=0;setTimeout(function(){if(count+1>countRun)
stopRunTimeSmall(iconRun);else
runTimeSmall(count+1,iconRun,tdx,tdy,val,sttStar);},timeSmall+timeDelay);}
function stopRunTimeSmall(iconStop){createjs.Tween.removeTweens(iconStop);containerStar.removeChild(iconStop);}
function getYbyX(x,r){var yy=2*r*x-x*x;return 0-Math.abs(Math.sqrt(yy));}
function getParabolY(x,tx,ty){var a=-(ty/(tx*tx));var b=2*(ty/tx);var y=a*x*x+b*x;return-y;}};item.prototype.moneyWinBt=function(money,callback){var txt='';txt+='<div class="effect_thangthuong"> ';txt+='<div class="nen_effect"> ';txt+='</div> ';txt+='<div class="star"> ';txt+='<span class="sao01"></span> ';txt+='<span class="sao03"></span> ';txt+='<span class="sao04"></span> ';txt+='<span class="sao05"></span> ';txt+='</div>   ';txt+='<div class="nen_effect_thangthuong">  ';txt+='<img src="'+ConfigVQS.UrlRoot+'images/XuTung/Thang/Thang_00.png" alt="" />';txt+='<img src="'+ConfigVQS.UrlRoot+'images/XuTung/Thang/Thang_01.png" alt="" />';txt+='<img src="'+ConfigVQS.UrlRoot+'images/XuTung/Thang/Thang_02.png" alt="" />';txt+='<img src="'+ConfigVQS.UrlRoot+'images/XuTung/Thang/Thang_03.png" alt="" />';txt+='<img src="'+ConfigVQS.UrlRoot+'images/XuTung/Thang/Thang_04.png" alt="" />';txt+='<img src="'+ConfigVQS.UrlRoot+'images/XuTung/Thang/Thang_05.png" alt="" />';txt+='<img src="'+ConfigVQS.UrlRoot+'images/XuTung/Thang/Thang_06.png" alt="" />';txt+='<img src="'+ConfigVQS.UrlRoot+'images/XuTung/Thang/Thang_07.png" alt="" />';txt+='<img src="'+ConfigVQS.UrlRoot+'images/XuTung/Thang/Thang_08.png" alt="" />';txt+='<img src="'+ConfigVQS.UrlRoot+'images/XuTung/Thang/Thang_09.png" alt="" />';txt+='<img src="'+ConfigVQS.UrlRoot+'images/XuTung/Thang/Thang_10.png" alt="" />';txt+='<img src="'+ConfigVQS.UrlRoot+'images/XuTung/Thang/Thang_11.png" alt="" />';txt+='<img src="'+ConfigVQS.UrlRoot+'images/XuTung/Thang/Thang_12.png" alt="" />';txt+='<img src="'+ConfigVQS.UrlRoot+'images/XuTung/Thang/Thang_13.png" alt="" />';txt+='<img src="'+ConfigVQS.UrlRoot+'images/XuTung/Thang/Thang_14.png" alt="" />';txt+='<img src="'+ConfigVQS.UrlRoot+'images/XuTung/Thang/Thang_15.png" alt="" />';txt+='<img src="'+ConfigVQS.UrlRoot+'images/XuTung/Thang/Thang_16.png" alt="" />';txt+='<img src="'+ConfigVQS.UrlRoot+'images/XuTung/Thang/Thang_17.png" alt="" />';txt+='<img src="'+ConfigVQS.UrlRoot+'images/XuTung/Thang/Thang_18.png" alt="" />';txt+='<img src="'+ConfigVQS.UrlRoot+'images/XuTung/Thang/Thang_19.png" alt="" />';txt+='<img src="'+ConfigVQS.UrlRoot+'images/XuTung/Thang/Thang_20.png" alt="" />';txt+='<img src="'+ConfigVQS.UrlRoot+'images/XuTung/Thang/Thang_21.png" alt="" />';txt+='<img src="'+ConfigVQS.UrlRoot+'images/XuTung/Thang/Thang_22.png" alt="" />';txt+='<img src="'+ConfigVQS.UrlRoot+'images/XuTung/Thang/Thang_23.png" alt="" />';txt+='<img src="'+ConfigVQS.UrlRoot+'images/XuTung/Thang/Thang_24.png" alt="" />';txt+='<img src="'+ConfigVQS.UrlRoot+'images/XuTung/Thang/Thang_25.png" alt="" />';txt+='</div>';txt+='<div class="text_effect_thuong">';txt+='<div style="clear:both;"></div>';txt+='<p><strong id="moneyWinVpt" style="margin: 140px;"><span></span></strong></p>';txt+='</div>';txt+='</div>';$('#vqhEffectWin').html(txt);$('#vqhEffectWin').show();setTimeout(function(){var timeNext=(vqsSlot.isAutoSpin)?4000:5000;that.countMoneyWin(money,1000);if(that.timeOutAnimation){clearTimeout(that.timeOutAnimation);that.timeOutAnimation=-1;}
$('.nen_effect_thangthuong img').first().addClass('active');if(vqsSlot.IntevalWin){clearInterval(vqsSlot.IntevalWin);}
vqsSlot.IntevalWin=setInterval(function(){if($('.nen_effect_thangthuong img').last().hasClass('active')){$('.nen_effect_thangthuong img.active').removeClass('active');$('.nen_effect_thangthuong img').first().addClass('active');}else{$('.nen_effect_thangthuong img.active').removeClass('active').next().addClass('active');}},80);that.timeOutAnimation=setTimeout(function(){$('#vqhEffectWin').hide();$('#vqhEffectWin').html("");if(typeof callback!='undefined'&&typeof callback=='function')
callback();},1500);$('#vqhEffectWin').unbind("click").bind("click",function(){$('#vqhEffectWin').hide();$('#vqhEffectWin').html("");clearTimeout(that.timeOutAnimation);if(typeof callback!='undefined'&&typeof callback=='function')
callback();});},200);var that=this;};item.prototype.showLine=function(number){if(vqsSlot.lineResult&&vqsSlot.lineResult.length>0){var that=this;if(number==-1){for(var i=0;i<vqsSlot.lineResult.length;i++){vqsSlot.ShowLineWin(vqsSlot.lineResult[i].LineID);$.each(vqsSlot.lineResult[i].Items,function(g){var numberG=vqsSlot.lineResult[i].Items[g];that.zoomItem(config.ResultPrizesData[numberG].X,config.ResultPrizesData[numberG].Y);});}
setTimeout(function(){if(vqsSlot.lineResult&&vqsSlot.lineResult.length>0){for(var k=0;k<vqsSlot.lineResult.length;k++){vqsSlot.HideLineWin(vqsSlot.lineResult[k].LineID);}
if(!vqsSlot.isAutoSpin)
that.showLine(number+1);}else{vqsSlot.hideAllLineWin();}},1500);}else if(number>=vqsSlot.lineResult.length){that.showLine(-1);}else{vqsSlot.ShowLineWin(vqsSlot.lineResult[number].LineID);$.each(vqsSlot.lineResult[number].Items,function(g){var numberN=vqsSlot.lineResult[number].Items[g];that.zoomItem(config.ResultPrizesData[numberN].X,config.ResultPrizesData[numberN].Y);});setTimeout(function(){if(vqsSlot.lineResult&&vqsSlot.lineResult.length>0){vqsSlot.HideLineWin(vqsSlot.lineResult[number].LineID);that.showLine(number+1);}else{vqsSlot.hideAllLineWin();}},1500);}}};item.prototype.bigWin=function(money,callback){var that=this;that.GetEffect("Home/EffectBigWin",function(){$('#vqhEffectWin').show();var timeNext=(vqsSlot.isAutoSpin)?4000:5000;that.countMoneyWin(money,timeNext-1000);if(that.timeOutAnimation){clearTimeout(that.timeOutAnimation);that.timeOutAnimation=-1;}
that.timeOutAnimation=setTimeout(function(){$('#vqhEffectWin').hide();$('#vqhEffectWin').html("");if(typeof callback!='undefined'&&typeof callback=='function')
callback();},timeNext);$('#vqhEffectWin').unbind("click").bind("click",function(){$('#vqhEffectWin').hide();$('#vqhEffectWin').html("");clearTimeout(that.timeOutAnimation);if(typeof callback!='undefined'&&typeof callback=='function')
callback();});});};item.prototype.bigSupperWin=function(money,callback){var that=this;that.GetEffect("Home/EffectSupperWin",function(){$('#vqhEffectWin').show();var timeNext=(vqsSlot.isAutoSpin)?4000:5000;that.countMoneyWin(money,timeNext-1000);if(that.timeOutAnimation){clearTimeout(that.timeOutAnimation);that.timeOutAnimation=-1;}
that.timeOutAnimation=setTimeout(function(){$('#vqhEffectWin').hide();$('#vqhEffectWin').html("");if(typeof callback!='undefined'&&typeof callback=='function')
callback();},timeNext);$('#vqhEffectWin').unbind("click").bind("click",function(){$('#vqhEffectWin').hide();$('#vqhEffectWin').html("");clearTimeout(that.timeOutAnimation);if(typeof callback!='undefined'&&typeof callback=='function')
callback();});});};item.prototype.startBonus=function(callback){var that=this;that.GetEffect("Home/EffectBonus",function(){$('#vqhEffectWin').show();var timeNext=(vqsSlot.isAutoSpin)?4000:5000;if(that.timeOutAnimation){clearTimeout(that.timeOutAnimation);that.timeOutAnimation=-1;}
that.timeOutAnimation=setTimeout(function(){$('#vqhEffectWin').hide();$('#vqhEffectWin').html("");if(typeof callback!='undefined'&&typeof callback=='function')
callback();},timeNext);$('#vqhEffectWin').unbind("click").bind("click",function(){$('#vqhEffectWin').hide();$('#vqhEffectWin').html("");clearTimeout(that.timeOutAnimation);if(typeof callback!='undefined'&&typeof callback=='function')
callback();});});};item.prototype.jackpot=function(money,totaljackpot,callback){var that=this;that.GetEffect("Home/EffectJackpot",function(){$('#vqhEffectWin').show();that.countMoneyWin(money,8000);$('#vqhEffectWin').unbind("click").bind("click",function(){$('#vqhEffectWin').hide();$('#vqhEffectWin').html("");clearTimeout(that.timeOutAnimation);if(typeof callback!='undefined'&&typeof callback=='function')
callback();});});};item.prototype.GetEffect=function(urlWin,callback){$.ajax({type:"GET",url:config.UrlRoot+urlWin,success:function(data){$('#vqhEffectWin').html(data);if(typeof callback!='undefined'&&typeof callback=='function')
callback();},fail:function(){}});};item.prototype.countMoneyWin=function(money,timeRun){if(timeRun==undefined||isNaN(timeRun)){timeRun=1000}
timeRun=timeRun/1000;if(money>0){var options={useEasing:true,useGrouping:true,separator:'.',decimal:','};var count=new CountUpNumber($("#moneyWinVpt"),0,money,0,timeRun,options,function(jp){var jpText=library.convertMoneyNumber(jp);$("#moneyWinVpt").html(jpText+'<span>'+jpText+'</span>');$("#vqh_moneyBet_Win").html("<i>Thắng:</i> "+jpText);});count.start();}};item.prototype.zoomItem=function(posX,posY){var item=vqsSlot.containerItem.getChildAt(posX).getChildAt(posY);createjs.Tween.get(item,{override:true}).to({scaleX:1.1,scaleY:1.1},300).to({rotation:-30},100).to({rotation:0},100).to({rotation:30},100).to({rotation:0},100).to({scaleX:0.9,scaleY:0.9},300);};scope.ItemGame=item;})(window.vuongquocsao,$);